<!DOCTYPE html>
<html lang="en-US">

<head>

<title>Smart Text Editor</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<meta name="author" content="Brandon Bennett">
<meta name="description" content="The text editor that requires only a browser and a keyboard!">
<meta name="google-site-verification" content="_LrfHy7pIualH1TolkQ5b3Po0dtjYrx-QQsiXelwx20">
<meta property="og:title" content="Smart Text Editor">
<meta property="og:description" content="The text editor that requires only a browser and a keyboard!">
<meta property="og:image" content="resources/share-1200.png">
<meta property="og:url" content="https://offroaders123.github.io/Smart-Text-Editor/">
<meta name="twitter:card" content="summary_large_image">
<meta id="theme_color" name="theme-color" content="#191919">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Smart Text Editor">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="canonical" href="https://offroaders123.github.io/Smart-Text-Editor/">
<link rel="manifest" href="manifest.webmanifest">
<link rel="icon" type="image/svg+xml" href="resources/icon.svg">
<link rel="alternate icon" type="image/png" sizes="16x16" href="resources/icon-16.png">
<link rel="alternate icon" type="image/png" sizes="32x32" href="resources/icon-32.png">
<link rel="apple-touch-icon" sizes="180x180" href="resources/icon-apple-touch-icon.png">
<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-iphone5-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-iphone5-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-iphone6-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-iphone6-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="resources/startup-iphoneplus-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="resources/startup-iphoneplus-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="resources/startup-iphonex-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="resources/startup-iphonex-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-iphonexr-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-iphonexr-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="resources/startup-iphonexsmax-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="resources/startup-iphonexsmax-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-ipad-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-ipad-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-ipadpro1-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-ipadpro1-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-ipadpro3-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-ipadpro3-portrait.png">
<link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="resources/startup-ipadpro2-landscape.png">
<link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="resources/startup-ipadpro2-portrait.png">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cousine&family=Rubik&display=swap">
<link rel="stylesheet" href="https://offroaders123.github.io/Numbered-Textarea-Plugin/styles.css">
<script src="https://offroaders123.github.io/Numbered-Textarea-Plugin/script.js"></script>

<script>
  window.Editor = {
    appearance: () => {
      var parent_window = (window.self == window.top),
        standalone = (window.matchMedia("(display-mode: standalone)").matches || navigator.standalone || !window.menubar.visible),
        apple_home_screen = (/(iPhone|iPad|iPod)/i.test(navigator.platform) && "standalone" in navigator && navigator.standalone),
        hidden_chrome = (window.outerWidth == window.innerWidth && window.outerHeight == window.innerHeight),
        fullscreen = (window.matchMedia("(display-mode: fullscreen)").matches || (!window.screenY && !window.screenTop && hidden_chrome) || (!window.screenY && !window.screenTop && standalone));
      return { parent_window, standalone, apple_home_screen, hidden_chrome, fullscreen };
    },
    environment: () => ({
      touch_device: ("ontouchstart" in window),
      apple_device: (/(Mac|iPhone|iPad|iPod)/i.test(navigator.platform)),
      macOS_device: (/(Mac)/i.test(navigator.platform) && navigator.standalone == undefined),
      electron_container: ("mainProcess" in window),
      mozilla_browser: (CSS.supports("-moz-appearance: none"))
    }),
    support: () => ({
      file_system: ("chooseFileSystemEntries" in window || "showOpenFilePicker" in window && !Editor.environment().electron_container),
      file_handling: ("launchQueue" in window && "LaunchParams" in window && !Editor.environment().electron_container),
      editing_commands: (!Editor.environment().mozilla_browser),
      web_sharing: ("share" in navigator)
    }),
    query: (identifier = Editor.active_editor) => ({
      tab: workspace_tabs.querySelector(`.tab[data-editor-identifier="${identifier}"]`),
      container: workspace_editors.querySelector(`.editor[data-editor-identifier="${identifier}"]`),
      textarea: workspace_editors.querySelector(`.editor[data-editor-identifier="${identifier}"] textarea`),
      getName: section => {
        if ((document.querySelectorAll(`[data-editor-identifier="${identifier}"]`).length == 0) && (identifier != Editor.active_editor)) return null;
        var name = workspace_tabs.querySelector(`.tab[data-editor-identifier="${identifier}"] [data-editor-name]`).innerText;
        if (!section || (!name.includes(".") && section == "base")) return name;
        if (section == "base"){
          name = name.split(".");
          name.pop();
          return name.join(".");
        }
        if (section == "extension"){
          if (!name.includes(".")) return "";
          return name.split(".").pop();
        }
      }
    }),
    view: () => document.body.getAttribute("data-view"),
    orientation: () => document.body.getAttribute("data-orientation"),
    active_orienting: () => (document.body.hasAttribute("data-orienting-active")),
    active_scaling: () => (document.body.hasAttribute("data-scaling-active")),
    unsaved_work: () => (!Editor.appearance().parent_window || (workspace_tabs.querySelectorAll(".tab[data-editor-unsaved]").length == 0)),
    preapproved_extensions: ["txt","html","css","js","php","json","webmanifest","xml","yaml","yml","dist","config","ini","md","markdown","mcmeta","lang","properties","uidx","material","h","fragment","vertex","fxh","hlsl","ihlsl","svg"],
    active_editor: null,
    preview_editor: "active-editor",
    file_handles: {},
    child_windows: [],
    storage: (window.location.protocol != "blob:") ? window.localStorage : null,
    refresh: true,
    active_editing_tools: false,
    active_dialog: null,
    dialog_previous: null,
    active_widget: null,
    context_menu_previous: null,
    context_menu_timeout: null,
    picker_color: null,
    insert_color: false,
    install_prompt: null
  };
  if (Editor.appearance().parent_window) document.documentElement.classList.add("startup-fade");
  if (Editor.appearance().apple_home_screen) document.documentElement.classList.add("apple-home-screen");
  if (Editor.environment().touch_device) document.documentElement.classList.add("touch-device");
  if (Editor.environment().apple_device) document.documentElement.classList.add("apple-device");
  if (Editor.environment().macOS_device) document.documentElement.classList.add("macOS-device");
  if (Editor.environment().electron_container) document.documentElement.classList.add("electron-container");
  if (Editor.support().web_sharing) document.documentElement.classList.add("web-sharing");
</script>

<style>
  *, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  :root {
    --selection-color: #0a0a0a;
    --selection-background: #b4d5ffbf;
    --selection-background-inactive: #ccccccbf;
  }
  :root:-moz-window-inactive {
    --selection-background: var(--selection-background-inactive);
  }
  html {
    width: 100%;
    height: 100%;
    overflow: hidden;
  }
  html.apple-home-screen {
    width: 100vw;
    height: 100vh;
  }
  body {
    position: fixed;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    color: #cccccc;
    font-size: 14px;
    font-family: -apple-system, BlinkMacSystemFont, "Rubik", sans-serif;
    background: #121212;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
  body::after {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    background: #191919;
    opacity: 0;
    pointer-events: none;
    z-index: 3;
    transition: opacity 0.25s;
  }
  :root.startup-fade body::after {
    opacity: 1;
    pointer-events: all;
  }
  body.split.horizontal[data-scaling-active] {
    cursor: col-resize;
  }
  body.split.vertical[data-scaling-active] {
    cursor: row-resize;
  }
  header {
    padding: env(safe-area-inset-top,0) env(safe-area-inset-right,0) 0 calc(env(safe-area-inset-left,0) + 8px);
    position: relative;
    display: flex;
    align-items: center;
    //gap: 8px;
    font-size: 13px;
    background: #191919;
    border-bottom: 1px solid #000000;
  }

/* -- Temp Flex Gap -- */

  header > *:not(:first-child) + * {
    margin-left: 8px;
  }


  :root.macOS-device.electron-container header {
    padding-top: 1px;
    padding-left: 68px;
    padding-right: 1px;
  }
  body[data-scaling-active] header {
    pointer-events: none;
  }
  header .app-region {
    margin: var(--app-region-margin);
    margin-bottom: 0;
    --app-region-margin: 2px;
    position: absolute;
    left: 0;
    top: 0;
    width: calc(100% - var(--app-region-margin) * 2);
    height: calc(100% - var(--app-region-margin));
    z-index: -1;
    -webkit-app-region: drag;
  }
  header .app-icon {
    flex-shrink: 0;
    display: flex;
  }
  header .app-icon img {
    width: 16px;height: 16px;
    //aspect-ratio: 1/1;
  }
  :root.macOS-device.electron-container header .app-icon {
    display: none;
  }
  header .menubar {
    min-width: 0;
    align-self: stretch;
    display: flex;
    z-index: 2;
    -webkit-app-region: no-drag;
  }
  header .menubar .menu {
    min-width: 0;
  }
  header .menubar .menu .opener {
    padding: 0 8px;
    display: unset;
    background: none;
    border: none;
    outline: none;
    overflow: hidden;
    text-overflow: ellipsis;
  }


  header .menubar .menu .opener:hover, header .menubar .menu .opener:focus, header .menubar .menu.active .opener {
    color: #ffffff;
    background: #ffffff20;
  }
  header .menubar .menu:not(.active) .opener:not(:hover):focus:not(:focus-visible) {
    color: inherit;
    background: none;
  }
  header .menubar .menu .opener:focus-visible {
    color: #ffffff;
    background: #ffffff20;
  }

/* -- Future Focus Visible --
  header .menubar .menu .opener:where(:hover,:focus-visible), header .menubar .menu.active .opener {
    color: #ffffff;
    background: #ffffff20;
  }
*/


  header .window-controls {
    margin-left: auto;
    align-self: stretch;
    flex-shrink: 0;
    display: flex;
    font-size: 10px;
    font-family: "Segoe MDL2 Assets";
    z-index: 4;
    -webkit-app-region: no-drag;
  }


  :root.macOS-device header .window-controls, :root:not(.electron-container) header .window-controls {
    width: 0;
    visibility: hidden;
    overflow: hidden;
  }

/* -- Future Where --
  :root:where(.macOS-device,:not(.electron-container)) header .window-controls {
    width: 0;
    visibility: hidden;
    overflow: hidden;
  }
*/


  header .window-controls .control {
    width: 46px;
    height: 32px;
    background: none;
    border: none;
    outline: none;
    transition: 100ms linear;
    transition-property: color, background;
  }


  header .window-controls .control:hover, header .window-controls .control:focus-visible {
    color: #ffffff;
    background: #ffffff20;
  }

/* -- Future Where --
  header .window-controls .control:where(:hover,:focus-visible) {
    color: #ffffff;
    background: #ffffff20;
  }
*/


  header .window-controls .control:active {
    transition: none;
  }
  header .window-controls .control:hover:active {
    background: #ffffff40;
  }
  header .window-controls .control[data-control="maximize"] [data-icon]:not(.active) {
    display: none;
  }


  header .window-controls .control[data-control="close"]:hover, header .window-controls .control[data-control="close"]:focus-visible {
    background: #e81123;
  }

/* -- Future Where --
  header .window-controls .control[data-control="close"]:where(:hover,:focus-visible) {
    background: #e81123;
  }
*/


  header .window-controls .control[data-control="close"]:hover:active {
    background: #94141e;
  }
  :root.macOS-device.electron-container header .window-controls .control {
    height: 27px;
  }
  main {
    padding: 0 env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);
    position: relative;
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    --workspace-background: #1f1f1f;
    --workspace-accent: #ffffff20;
    --preview-border-color: #141414;
  }
  main .workspace {
    position: absolute;
    left: 0;
    top: 0;
    display: flex;
    flex-direction: column;
  }
  body.code main .workspace {
    width: 100%;
    height: 100%;
  }
  body.split.horizontal main .workspace {
    width: 50%;
    height: 100%;
  }
  body.split.vertical main .workspace {
    width: 100%;
    height: 50%;
  }
  body.split.horizontal[data-scaling-offset] main .workspace {
    width: var(--scaling-offset);
  }
  body.split.vertical[data-scaling-offset] main .workspace {
    height: var(--scaling-offset);
  }
  body.preview.horizontal main .workspace {
    width: 0%;
    height: 100%;
  }
  body.preview.vertical main .workspace {
    width: 100%;
    height: 0%;
  }
  body[data-scaling-active] main .workspace {
    pointer-events: none;
    transition: none;
  }
  main .workspace .workspace-tabs {
    padding-left: calc(env(safe-area-inset-left,0) + 6px);
    padding-right: calc(env(safe-area-inset-right,0) + 6px);
    flex-shrink: 0;
    display: flex;
    gap: 3px;
    box-shadow: 0 -1px 0 var(--workspace-accent) inset, 0 -1px 0 var(--workspace-background) inset;
    overflow-x: auto;
    scroll-behavior: smooth;
    scrollbar-width: none;
  }
  main .workspace .workspace-tabs::-webkit-scrollbar {
    display: none;
  }
  main .workspace .workspace-tabs .tab {
    margin-top: 3px;
    padding: calc(6px - var(--tab-border-width));
    padding-left: calc(10px - var(--tab-border-width));
    padding-bottom: calc(7px - var(--tab-border-width));
    flex-shrink: 0;
    gap: 6px;
    color: #aaaaaa;
    font-size: 12px;
    background: none;
    outline: none;
  }
  main .workspace .workspace-tabs .tab:focus-visible {
    border-bottom-color: #ffffff80;
  }
  main .workspace .workspace-tabs .tab.active {
    color: #eaeaea;
    background: var(--workspace-background);
    border-left-color: var(--workspace-accent);
    border-top-color: var(--workspace-accent);
    border-right-color: var(--workspace-accent);
  }
  main .workspace .workspace-tabs .tab[data-editor-unsaved] {
    font-style: italic;
  }
  main .workspace .workspace-tabs .tab [data-editor-rename] {
    margin: calc(calc(var(--editor-rename-padding-y) + var(--editor-rename-border)) * -1) calc(calc(var(--editor-rename-padding-x) + var(--editor-rename-border)) * -1);
    padding: var(--editor-rename-padding-y) var(--editor-rename-padding-x);
    --editor-rename-padding-x: 4px;
    --editor-rename-padding-y: 3px;
    width: calc(var(--editor-name-width) + calc(var(--editor-rename-padding-x) + var(--editor-rename-border)) * 2);
    color: inherit;
    font-size: inherit;
    font-family: inherit;
    background: none;
    border: var(--editor-rename-border) solid #ffffff80;
    border-radius: 4px;
    --editor-rename-border: 1px;
  }
  main .workspace .workspace-tabs .tab [data-editor-name] {
    pointer-events: none;
  }
  main .workspace .workspace-tabs .tab [data-editor-rename] ~ [data-editor-name] {
    display: none;
  }
  main .workspace .workspace-tabs .tab[data-editor-unsaved] [data-editor-name]::after {
    content: "*";
    margin-left: 0.5ch;
    font-size: 13px;
    font-style: normal;
    line-height: 12px;
  }
  main .workspace .workspace-editors {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  :root:not(.startup-fade) main .workspace .workspace-editors:empty {
    border: solid transparent;
    border-width: 0 env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);
  }
  :root:not(.startup-fade) main .workspace .workspace-editors:empty::before {
    content: "No Editors Open";
  }
  :root:not(.startup-fade) body.split.horizontal main .workspace .workspace-editors:empty {
    border-right: none;
  }
  @media (orientation: portrait) {
    :root:not(.startup-fade) body.split.horizontal main .workspace .workspace-editors:empty {
      border-bottom-color: var(--preview-border-color);
    }
  }
  :root:not(.startup-fade) body.split.vertical main .workspace .workspace-editors:empty {
    border-bottom: none;
  }
  main .workspace .editor {
    position: absolute;
    width: 100%;
    height: 100%;
    background: var(--workspace-background);
    border: solid transparent;
    border-width: 0 env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);
    visibility: hidden;
  }
  body.split.horizontal main .workspace .editor {
    border-right: none;
  }
  @media (orientation: portrait) {
    body.split.horizontal main .workspace .editor {
      border-bottom-color: var(--preview-border-color);
    }
  }
  body.split.vertical main .workspace .editor {
    border-bottom: none;
  }
  main .workspace .editor:not(.active) {
    z-index: -1;
  }
  main .workspace .editor.active {
    visibility: visible;
  }
  main .scaler {
    position: absolute;
    touch-action: none;
    z-index: 1;
  }
  main .scaler:hover, body[data-scaling-active] main .scaler {
  }
  body.horizontal main .scaler {
    top: 0;
    width: 8px;
    height: 100%;
    cursor: col-resize;
  }
  body.vertical main .scaler {
    left: 0;
    width: 100%;
    height: 8px;
    cursor: row-resize;
  }
  body.code.horizontal main .scaler {
    left: 100%;
  }
  body.code.vertical main .scaler {
    top: 100%;
  }
  body.split.horizontal main .scaler {
    left: calc(50% - 4px);
  }
  body.split.vertical main .scaler {
    top: calc(50% - 4px);
  }
  body.split.horizontal[data-scaling-offset] main .scaler {
    left: calc(var(--scaling-offset) - 4px);
  }
  body.split.vertical[data-scaling-offset] main .scaler {
    top: calc(var(--scaling-offset) - 4px);
  }
  body.preview.horizontal main .scaler {
    left: -8px;
  }
  body.preview.vertical main .scaler {
    top: -8px;
  }
  body[data-scaling-active] main .scaler {
    transition: none;
  }
  main .preview {
    position: absolute;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 50%;
    background: #ffffff;
    border: solid var(--preview-border-color);
    border-width: 0 env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);
  }
  body.code.horizontal main .preview {
    width: 0%;
    height: 100%;
    border-left: none;
    border-right: none;
  }
  body.code.vertical main .preview {
    width: 100%;
    height: 0%;
    border-bottom: none;
  }
  body.split.horizontal main .preview {
    width: 50%;
    height: 100%;
    border-left: none;
  }
  body.split.vertical main .preview {
    width: 100%;
    height: 50%;
  }
  body.split.horizontal[data-scaling-offset] main .preview {
    width: calc(100% - var(--scaling-offset));
  }
  body.split.vertical[data-scaling-offset] main .preview {
    height: calc(100% - var(--scaling-offset));
  }
  body.preview main .preview {
    width: 100%;
    height: 100%;
  }
  body[data-scaling-active] main .preview {
    pointer-events: none;
    transition: none;
  }
  button {
    color: inherit;
    font-size: inherit;
    font-family: inherit;
  }
  a {
    color: inherit;
    text-decoration: none;
  }
  [data-numbered-container], input[type="text"] {
    color: #eaeaea;
    caret-color: #eaeaea;
    font-size: 13px;
    font-family: "Cousine", monospace;
    line-height: 1.2;
    background: #252525;
    border: none;
    outline: none;
  }
  [data-numbered-container] {
    position: relative;
  }
  [data-numbered-container] ol {
    padding: 8px 16px;
    color: inherit;
    line-height: inherit;
    background: transparent;
    border: none;
    opacity: 0.55;
  }
  [data-numbered-container] textarea {
    padding: 8px;
    line-height: inherit;
    resize: none;
    scrollbar-width: inherit;
    scrollbar-color: inherit;
  }
  input[type="text"] {
    padding: 8px;
    border-radius: 0;
    -webkit-appearance: none;
  }
  ::selection {
    color: var(--selection-color);
    background: var(--selection-background);
  }
  ::selection:window-inactive {
    background: var(--selection-background-inactive);
  }
  ::-webkit-scrollbar {
    width: 16px;
    height: 16px;
  }
  ::-webkit-scrollbar-track, ::-webkit-scrollbar-corner {
    background: none;
  }
  ::-webkit-scrollbar-thumb {
    width: 36px;
    height: 36px;
    background: #797979;
    background-clip: content-box;
    border: 4px solid transparent;
    border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background-color: #999999;
  }
  .tab {
    display: flex;
    justify-content: center;
    align-items: center;
    background: none;
    border: var(--tab-border-width) solid transparent;
    --tab-border-width: 1px;
    border-radius: calc(6px + var(--tab-border-width));
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    overflow: hidden;
  }
  .tab .option {
    margin: calc(var(--option-border-width) * -1);
    padding: 4px;
    display: flex;
    align-items: center;
    background: none;
    background-clip: padding-box;
    border: var(--option-border-width) solid transparent;
    --option-border-width: 4px;
    border-radius: calc(4px + var(--option-border-width));
    outline: none;
  }



  .tab .option:hover, .tab .option:focus-visible {
    color: #ffffff;
    background-color: #ffffff20;
  }

/* -- Future Where --
  .tab .option:where(:hover,:focus-visible) {
    color: #ffffff;
    background-color: #ffffff20;
  }
*/


  .tab .option svg {
    width: 8px;height: 8px;
    //aspect-ratio: 1/1;
    fill: currentColor;
  }
  .menu {
    position: relative;
    display: flex;
  }
  .menu.context-menu {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 2;
  }
  .menu .opener {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .menu .list {
    padding: var(--list-padding-y) var(--list-padding-x);
    --list-padding-x: 0px;
    --list-padding-y: 5px;
    position: absolute;
    left: 0;
    top: 100%;
    color: #cccccc;
    font-size: 13px;
    background: #2a2a2a;
    border: var(--list-border) solid #ffffff1a;
    --list-border: 1px;
    border-radius: calc(var(--list-padding-y) + var(--list-border));
    box-shadow: 1px 2px 4px #00000080;
    visibility: hidden;
    z-index: 1;
    list-style: none;
  }
  :root.apple-device .menu .list {
    --list-padding-x: 5px;
    border-color: #ffffff20;
  }
  .menu:not(.context-menu) > .list {
    border-top: none;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
  }
  .menu .list.selectable {
    --list-item-selected-icon-size: 10px;
  }
  .menu .list-item {
    padding: calc(var(--list-item-padding-y) - var(--list-item-border)) calc(var(--list-item-padding-x) - var(--list-item-border));
    padding-left: calc(var(--list-item-padding-x) + var(--list-item-selected-icon-size,0px) - var(--list-item-border));
    --list-item-padding-x: 12px;
    --list-item-padding-y: 3px;
    position: relative;
    display: flex;
    align-items: center;
    gap: 8px;
    border: var(--list-item-border) solid transparent;
    --list-item-border: 1px;
    outline: none;
    white-space: nowrap;
  }
  :root.apple-device .menu .list-item {
    --list-item-padding-x: 8px;
    border-radius: calc(var(--list-padding-y) - var(--list-border));
  }


  .menu .list-item:hover, .menu .list-item:focus-visible, .select .menu .list-item:focus {
    color: #ffffff;
    background: hsl(213,94%,43%,0.75);
  }

/* -- Future Where --
  .menu .list-item:where(:hover,:focus-visible), .select .menu .list-item:focus {
    color: #ffffff;
    background: hsl(213,94%,43%,0.75);
  }
*/


  .menu .list-item:focus-visible, .select .menu .list-item:focus {
    border-color: #c0c0c0;
  }
  .menu .list.selectable .list-item.selected::before {
    content: "";
    margin-left: calc(var(--list-item-padding-x) * 0.5 - var(--list-item-border));
    position: absolute;
    left: 0;
    width: var(--list-item-selected-icon-size);
    height: var(--list-item-selected-icon-size);
    background: currentColor;
    mask: var(--list-item-selected-icon-source);
    -webkit-mask: var(--list-item-selected-icon-source);
    --list-item-selected-icon-source: url("data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%20512%20512%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%20%20%3Cpath%20d%3D%22m63.346%20191.15%20192.72%20192.72-63.402%2063.402-192.72-192.72z%22%2F%3E%0A%20%20%3Cpath%20d%3D%22m129.5%20383.87%20319.15-319.15%2063.402%2063.402-319.15%20319.15z%22%2F%3E%0A%3C%2Fsvg%3E");
    pointer-events: none;
  }
  .menu .list-item.hidden {
    //display: none;
  }
  .menu.context-menu.link > .list .list-item:not(.link):not(.global), .menu.context-menu.editing > .list .list-item:not(.editing):not(.global), :root:not(.web-sharing) .menu.context-menu > .list .list-item.web-sharing:not(.global), :root.web-sharing .menu.context-menu > .list .list-item.web-sharing-alt:not(.global) {
    display: none;
  }
  .menu .list-item > img {
    width: 16px;height: 16px;
    //aspect-ratio: 1/1;
  }
  .menu .list-item > img.invert {
    filter: invert() hue-rotate(180deg);
  }
  .menu .list-item > img.rounded {
    border-radius: 3px;
  }
  .menu .list-item .info {
    margin-left: auto;
    padding-left: 8px;
    font-size: 12px;
    opacity: 0.6;
    pointer-events: none;
  }
  .menu .list-item svg.info {
    box-sizing: content-box;
    width: 12px;height: 12px;
    //aspect-ratio: 1/1;
    fill: currentColor;
  }


  .menu .list-item:not(.list-parent):hover .info, .menu .list-item:not(.list-parent):focus-visible .info {
    opacity: 1;
  }

/* -- Future Where --
  .menu .list-item:not(.list-parent):where(:hover,:focus-visible) .info {
    opacity: 1;
  }
*/


  .menu .list-parent.active {
    color: #ffffff;
    background: hsl(213,94%,43%,0.75);
  }


  .menu .list-parent:hover > svg.info, .menu .list-parent:focus-visible > svg.info, .menu .list-parent.active > svg.info {
    opacity: 1;
  }

/* -- Future Where --
  .menu .list-parent:where(:hover,:focus-visible,.active) > svg.info {
    opacity: 1;
  }
*/


  .menu .list hr {
    margin: calc(var(--list-padding-y) * 0.6) calc(var(--list-padding-y) * 2);
    margin-left: calc(var(--list-padding-y) * 2 + var(--list-item-selected-icon-size,0px));
    border: none;
    border-top: 1px solid currentColor;
    opacity: 0.6;
  }
  :root.apple-device .menu .list hr {
    margin-left: calc(var(--list-padding-y) + var(--list-item-selected-icon-size,0px));
    margin-right: var(--list-padding-y);
  }
  .menu .list hr:last-child {
    display: none;
  }
  .menu .list .list {
    left: calc(100% + var(--list-padding-x) + var(--list-border) + var(--list-item-border));
    top: calc(calc(var(--list-padding-y) + var(--list-border) + var(--list-item-border)) * -1);
  }
  :root.apple-device .menu .list .list {
    left: calc(100% + var(--list-item-border));
  }
  .menu.active > .list, .menu .list-parent.active > .list {
    visibility: visible;
  }
  :root:not(.apple-device) .shortcut.ctrl::before {
    content: "Ctrl + ";
  }
  :root:not(.apple-device) .shortcut.ctrl-shift::before {
    content: "Ctrl + Shift + ";
  }
  :root.apple-device .shortcut.command::before {
    content: "\2318";
  }
  :root.apple-device .shortcut.shift-command::before {
    content: "\21E7\2318";
  }
  :root.apple-device .shortcut.ctrl-command::before {
    content: "\2303\2318";
  }
  .select {
    display: flex;
    justify-content: center;
  }
  .select label {
    margin-right: 4px;
    display: flex;
    align-items: center;
  }
  .select .menu .opener {
    padding: 2px 8px;
    justify-content: space-between;
    background: #3a3a3a;
    border: 1px solid transparent;
    border-radius: 4px;
    outline: none;
  }


  .select .menu .opener:hover, .select .menu .opener:focus-visible, .select .menu.active .opener {
    color: #ffffff;
    background: #4a4a4a;
  }

/* -- Future Where --
  .select .menu .opener:where(:hover,:focus-visible), .select .menu.active .opener {
    color: #ffffff;
    background: #4a4a4a;
  }
*/


  .select .menu .opener:focus-visible {
    border-color: #c0c0c0;
  }
  .select .menu.active .opener {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }
  .select .menu .opener svg {
    margin-left: 10px;
    width: 10px;height: 10px;
    //aspect-ratio: 1/1;
    fill: currentColor;
    transform: rotate(270deg);
  }
  .select .menu > .list {
    min-width: 100%;
  }
  .checkbox {
    margin: calc(var(--checkbox-padding) * -1);
    padding: var(--checkbox-padding);
    --checkbox-padding: 3px;
    display: flex;
    justify-content: center;
    align-items: center;
    border: var(--checkbox-border) solid transparent;
    --checkbox-border: 1px;
    border-radius: calc(var(--checkbox-padding) * 2);
    outline: none;
  }
  .checkbox:where(:hover,:focus-visible) {
    color: #ffffff;
  }
  .checkbox:focus-visible {
    border-color: currentColor;
  }
  .checkbox input[type="checkbox"] {
    display: none;
  }
  .checkbox label {
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
  }
  .checkbox label .check {
    margin-right: 4px;
    padding: var(--check-padding);
    --check-padding: 2px;
    width: calc(14px + var(--check-padding) + var(--check-border-width));height: calc(14px + var(--check-padding) + var(--check-border-width));
    //aspect-ratio: 1/1;
    fill: transparent;
    border: var(--check-border-width) solid currentColor;
    --check-border-width: 2px;
    border-radius: calc(1px + var(--check-padding) + var(--check-border-width));
  }
  .checkbox input[type="checkbox"]:checked + label .check {
    fill: currentColor;
  }
  .card {
    display: flex;
    flex-direction: column;
    background: #191919;
    border: 1px solid transparent;
    border-radius: 8px;
    box-shadow: 1px 2px 4px #00000060;
    visibility: hidden;
    overflow: hidden;
  }
  :root.apple-device .card {
    border-color: #ffffff30;
  }
  .card.active {
    visibility: visible;
  }
  .card.alert {
    position: absolute;
    right: 0;
    bottom: 0;
    z-index: 3;
  }
  .card.widget {
    position: absolute;
    right: 0;
    top: 0;
    z-index: 1;
  }
  .card.dialog {
    position: absolute;
    border-radius: 12px;
    z-index: 2;
  }
  .card .header {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  :root.apple-device .card .header {
    background: #ffffff14;
    border-bottom: 1px solid #000000;
  }
  .card .header .card-back {
    margin-right: auto;
    padding: 8px;
    display: flex;
    background: none;
    border: none;
    outline: none;
  }
  :root.macOS-device .card .header .card-back {
    padding: 4px;
    border-radius: 4px;
  }
  .card .header .card-back:not([data-card-parent]) {
    display: none;
  }


  .card .header .card-back:hover, .card .header .card-back:focus-visible {
    color: #ffffff;
    background: #ffffff20;
  }

/* -- Future Where --
  .card .header .card-back:where(:hover,:focus-visible) {
    color: #ffffff;
    background: #ffffff20;
  }
*/


  .card .header .card-back svg {
    width: 12px;height: 12px;
    //aspect-ratio: 1/1;
    fill: currentColor;
  }
  .card .header .title {
    //margin: 0 auto;
    position: absolute;
  }/*
  :root.macOS-device .card .header .title {
    margin-left: 16px;
    font-weight: bold;
  }*/
  .card.dialog .header .title {
    font-size: 18px;
  }
  .card .header .card-controls {
    margin-left: auto;
    display: flex;
  }
  :root.macOS-device .card .header .card-controls {
    margin: 8px;
    padding: 4px;
    gap: 8px;
  }
  .card .header .card-controls .control {
    display: flex;
    background: var(--control-background);
    border: none;
    outline: none;
  }
  :root:not(.macOS-device) .card .header .card-controls .control {
    padding: 8px;
    --control-background: none;
  }


  :root:not(.macOS-device) .card .header .card-controls .control:hover, :root:not(.macOS-device) .card .header .card-controls .control:focus-visible {
    color: #ffffff;
    --control-background: #ffffff20;
  }

/* -- Future Where
  :root:not(.macOS-device) .card .header .card-controls .control:where(:hover,:focus-visible) {
    color: #ffffff;
    --control-background: #ffffff20;
  }
*/


  :root:not(.macOS-device) .card .header .card-controls .control[data-control="close"]:hover {
    --control-background: #e81123;
  }
  :root.macOS-device .card .header .card-controls .control {
    padding: 3px;
    border-radius: 50%;
  }
  :root.macOS-device .card .header .card-controls .control[data-control="minimize"] {
    --control-background: #fcbb40;
  }
  :root.macOS-device .card .header .card-controls .control[data-control="minimize"]:hover:active {
    --control-background: #fee867;
  }
  :root.macOS-device .card .header .card-controls .control[data-control="close"] {
    --control-background: #fc605c;
  }
  :root.macOS-device .card .header .card-controls .control[data-control="close"]:hover:active {
    --control-background: #fd8e87;
  }
  .card:not(.widget) .header .card-controls .control[data-control="minimize"] {
    display: none;
  }
  .card .header .card-controls .control svg {
    fill: currentColor;
  }
  :root:not(.macOS-device) .card .header .card-controls .control svg {
    width: 12px;height: 12px;
    //aspect-ratio: 1/1;
  }
  :root:not(.macOS-device) .card .header .card-controls .control[data-control="close"]:hover svg {
    color: #ffffff;
  }
  :root.macOS-device .card .header .card-controls .control svg {
    width: 6px;height: 6px;
    //aspect-ratio: 1/1;
    color: transparent;
    mix-blend-mode: luminosity;
  }


  :root.macOS-device .card .header .card-controls:hover .control svg, :root.macOS-device .card .header .card-controls:focus-visible .control svg {
    color: #202020bf;
  }

/* -- Future Where --
  :root.macOS-device .card .header .card-controls:where(:hover,:active) .control svg {
    color: #202020bf;
  }
*/


  .card .main {
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .card .main .content {
    display: flex;
    justify-content: space-around;
  }
  .card .main .content .item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  .card .main .content .item.start {
    align-items: flex-start;
  }
  .card .options {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
  }
  .card .options button {
    padding: 3px 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    background: #3a3a3a;
    border: 1px solid transparent;
    border-radius: 4px;
    outline: none;
  }


  .card .options button:hover, .card .options button:focus-visible {
    color: #ffffff;
    background: #4a4a4a;
  }

/* -- Future Where --
  .card .options button:where(:hover,:focus-visible) {
    color: #ffffff;
    background: #4a4a4a;
  }
*/


  .card .options button:focus-visible {
    border-color: currentColor;
  }
  .card .options button.hidden {
    //display: none;
  }
  .card .options button > img {
    width: 16px;height: 16px;
    //aspect-ratio: 1/1;
  }
  .card .options button > svg {
    width: 12px;height: 12px;
    //aspect-ratio: 1/1;
    fill: currentColor;
  }
  .card [data-numbered-container] {
    width: 32ch;
    height: 12ch;
    background: #ffffff0a;
    border: 1px solid #000000bf;
    border-radius: 6px;
  }
  .card [data-numbered-container] ol {
    padding-left: 12px;
    padding-right: 12px;
  }
  .card input[type="text"] {
    background: #ffffff0c;
    border: 1px solid #00000080;
    border-radius: 6px;
  }
  .card-backdrop {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: #19191960;
    visibility: hidden;
    z-index: 2;
  }
  .card-backdrop.active {
    visibility: visible;
  }
  #symbol_definitions {
    display: none;
  }
  #install_button + button::before {
    content: "Theme";
  }
  #install_button.hidden + button::before {
    content: "Customize Theme";
  }
</style>

<style id="theme_styles"></style>

</head>

<body class="code horizontal" data-view="code" data-orientation="horizontal">

<svg id="symbol_definitions">
  <symbol id="arrow_icon" viewBox="0 0 512 512">
    <path d="m112.66 0 286.68 256-286.68 256z"/>
  </symbol>
  <symbol id="check_icon" viewBox="0 0 512 512">
    <path d="m63.346 191.15 192.72 192.72-63.402 63.402-192.72-192.72z"/>
    <path d="m129.5 383.87 319.15-319.15 63.402 63.402-319.15 319.15z"/>
  </symbol>
  <symbol id="back_icon" viewBox="0 0 512 512">
    <path d="m160.8 191.81 254.36 254.36-64 64-254.36-254.36z"/>
    <path d="m96.833 255.86 254.36-254.36 64 64-254.36 254.36z"/>
  </symbol>
  <symbol id="minimize_icon" viewBox="0 0 512 512">
    <path d="m30.33 211.17h451.34v89.669h-451.34z"/>
  </symbol>
  <symbol id="close_icon" viewBox="0 0 512 512">
    <path d="m1.5795 65.78 64.201-64.201 190.22 190.22 190.22-190.22 64.201 64.201-190.22 190.22 190.22 190.22-64.201 64.201-190.22-190.22-190.22 190.22-64.201-64.201 190.22-190.22z"/>
  </symbol>
  <symbol id="rename_icon" viewBox="0 0 512 512">
    <path d="m-0.0618 512.07v-128.63l128.63 128.63z"/>
    <path d="m383.21 0.052969 128.72 128.72-88.63 88.63-128.72-128.72z"/>
    <path d="m252.59 130.63 128.72 128.72-210.68 210.68-128.72-128.72z"/>
  </symbol>
  <symbol id="undo_icon" viewBox="0 0 512 512">
    <path d="m133.64 437.65-133.64-133.64h267.28z"/>
    <path d="m512 249c-0.72363-111.33-91.271-201.16-202.61-200.98-111.33 0.17137-201.61 90.272-201.99 201.61l52.695 0.18028c0.28168-82.334 67.039-148.97 149.37-149.09 82.334-0.12673 149.3 66.299 149.83 148.63z"/>
    <path d="m107.4 246.77h52.472v57.48h-52.472z"/>
    <path d="m459.53 246.77h52.472v190.87h-52.472z"/>
  </symbol>
  <symbol id="redo_icon" viewBox="0 0 512 512">
    <path d="m378.36 437.65 133.64-133.64h-267.28z"/>
    <path d="m0.0044544 249c0.72363-111.33 91.271-201.16 202.61-200.98 111.33 0.17137 201.61 90.272 201.99 201.61l-52.695 0.18028c-0.28168-82.334-67.039-148.97-149.37-149.09-82.334-0.12673-149.3 66.299-149.83 148.63z"/>
    <path d="m404.6 246.77h-52.472v57.48h52.472z"/>
    <path d="m52.473 246.77h-52.472v190.87h52.472z"/>
  </symbol>
  <symbol id="refresh_icon" viewBox="0 0 512 512">
    <path d="m510.27 285.75c-13.893 118.73-108.1 212.04-226.96 224.79-118.86 12.751-230.71-58.451-269.47-171.53-38.761-113.08 5.8941-237.93 107.58-300.78 101.68-62.846 233.32-46.955 317.13 38.282l-37.067 36.446c-66.79-67.929-171.7-80.593-252.74-30.508-81.036 50.084-116.62 149.58-85.733 239.7 30.89 90.117 120.03 146.86 214.75 136.7 94.721-10.161 169.8-84.522 180.87-179.14z"/>
    <path d="m512 189.01v-189.01l-188.98 189.01z"/>
  </symbol>
</svg>

<header id="header">
  <section class="app-region"></section>
  <section class="app-icon">
    <img src="resources/icon.svg">
  </section>
  <section class="menubar">
    <div class="menu">
      <button class="opener">File</button>
      <ul class="list">
        <li class="list-item" onclick="createEditor();">New Editor<span class="info shortcut ctrl-shift shift-command">X</span></li>
        <li class="list-item" onclick="createWindow();">New Window<span class="info shortcut ctrl-shift shift-command">C</span></li>
        <li class="list-item" onclick="openFiles();">Open<span class="info shortcut ctrl command">O</span></li>
        <li class="list-item" onclick="window.setTimeout(renameEditor,10);">Rename<span class="info shortcut ctrl-shift shift-command">R</span></li>
        <li class="list-item" onclick="saveFile();">Save<span class="info shortcut ctrl command">S</span></li>
        <li class="list-item list-parent">Save As...<svg class="info"><use href="#arrow_icon"/></svg>
          <ul class="list">
            <li class="list-item" onclick="saveFile('txt');">Plain Text<span class="info">.txt</span></li>
            <li class="list-item" onclick="saveFile('html');">HTML<span class="info">.html</span></li>
            <li class="list-item" onclick="saveFile('css');">CSS<span class="info">.css</span></li>
            <li class="list-item" onclick="saveFile('js');">JavaScript<span class="info">.js</span></li>
            <li class="list-item" onclick="saveFile('json');">JSON<span class="info">.json</span></li>
            <li class="list-item" onclick="saveFile('svg');">SVG<span class="info">.svg</span></li>
            <li class="list-item list-parent">More...<svg class="info"><use href="#arrow_icon"/></svg>
              <ul class="list">
                <li class="list-item" onclick="saveFile('webmanifest');">Web Manifest<span class="info">.webmanifest</span></li>
                <li class="list-item" onclick="saveFile('md');">Markdown<span class="info">.md</span></li>
                <li class="list-item" onclick="saveFile('mcmeta');">MCMETA<span class="info">.mcmeta</span></li>
                <li class="list-item" onclick="saveFile('xml');">XML<span class="info">.xml</span></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="menu">
      <button class="opener">View</button>
      <ul class="list selectable">
        <li class="list-item selected" onclick="setView('code');">Code<span class="info shortcut ctrl-shift ctrl-command">1</span></li>
        <li class="list-item" onclick="setView('split');">Split<span class="info shortcut ctrl-shift ctrl-command">2</span></li>
        <li class="list-item" onclick="setView('preview');">Preview<span class="info shortcut ctrl-shift ctrl-command">3</span></li>
        <hr>
        <li class="list-item non-selectable" onclick="setOrientation();">Orientation<span class="info shortcut ctrl-shift ctrl-command">4</span></li>
        <li class="list-item non-selectable" onclick="createDisplay();">Display<span class="info shortcut ctrl-shift ctrl-command">5</span></li>
      </ul>
    </div>
    <div class="menu">
      <button class="opener">Preview</button>
      <ul id="preview_options" class="list selectable">
        <li class="list-item selected" onclick="setPreviewSource({ active_editor: true });">Active Editor</li>
        <hr>
      </ul>
    </div>
    <div class="menu">
      <button class="opener">Tools</button>
      <ul class="list">
        <li class="list-item" onclick="openCard(editing_tools_card);">Editing Tools<span class="info shortcut ctrl-shift shift-command">E</span></li>
        <li class="list-item" onclick="openCard(replace_text_card);">Replace Text<span class="info shortcut ctrl-shift shift-command">F</span></li>
        <li class="list-item" onclick="openCard(color_picker_card);">Color Picker<span class="info shortcut ctrl-shift shift-command">K</span></li>
        <li class="list-item" onclick="openCard(json_formatter_card);">JSON Formatter<span class="info shortcut ctrl-shift shift-command">G</span></li>
        <li class="list-item" onclick="openCard(uri_encoder_card);">URI Encoder<span class="info shortcut ctrl-shift shift-command">Y</span></li>
        <li class="list-item" onclick="confirmOverwrite(insertTemplate);">Import HTML Template<span class="info shortcut ctrl-shift shift-command">H</span></li>
        <li class="list-item list-parent">Online Resources...<svg class="info"><use href="#arrow_icon"/></svg>
          <ul class="list">
            <a class="list-item" href="https://webformatter.com"><img src="resources/web-formatter.svg">Code Formatter</a>
            <a class="list-item" href="https://www.sharedrop.io"><img class="invert" src="resources/sharedrop.svg">File Transferer</a>
            <a class="list-item" href="https://www.diffchecker.com/"><img src="resources/diffchecker.svg">Difference Finder</a>
            <a class="list-item" href="https://caniuse.com/"><img src="resources/caniuse.svg">Compatibility Checker</a>
            <a class="list-item" href="https://web.dev/measure/"><img src="resources/webdev.svg">Performance Tester</a>
            <a class="list-item" href="https://realfavicongenerator.net/"><img class="rounded" src="resources/real-favicon-generator.svg">Favicon Generator</a>
            <a class="list-item" href="https://appsco.pe/developer/splash-screens/"><img class="invert" src="resources/appscope.svg">Splash Generator</a>
            <a class="list-item" href="https://www.svgminify.com/"><img src="resources/svgminify.svg">SVG Simplifier</a>
            <a class="list-item" href="https://www.uuidgenerator.net/"><img src="resources/online-uuid-generator.svg">UUID Generator</a>
            <a class="list-item" href="https://cryptii.com/"><img src="resources/cryptii.svg">Text Encryptor</a>
          </ul>
        </li>
      </ul>
    </div>
    <div class="menu alternate">
      <button class="opener" onclick="openCard(settings_card);">Settings</button>
      <ul class="list">
        <li id="install_option" class="list-item hidden" onclick="installApp();"><img src="resources/icon.svg">Install</button>
        <li class="list-item" onclick="openCard(theme_card); Editor.dialog_previous = this.closest('.menu').querySelector('button');">Theme Settings</li>
        <li class="list-item" id="clear_cache_option" class="hidden" onclick="clearCache();">Clear Cache</li>
        <li class="list-item" onclick="resetSettings();">Reset Settings</li>
      </ul>
    </div>
  </section>
  <section class="window-controls">
    <button class="control" data-control="minimize" title="Minimize">&#xE921;</button>
    <button class="control" data-control="maximize" title="Maximize">
      <span data-icon="maximize" class="active">&#xE922;</span>
      <span data-icon="restore">&#xE923;</span>
    </button>
    <button class="control" data-control="close" title="Close">&#xE8BB;</button>
  </section>
</header>

<main id="main">
  <section id="workspace" class="workspace">
    <section id="workspace_tabs" class="workspace-tabs"></section>
    <section id="workspace_editors" class="workspace-editors"></section>
  </section>
  <section id="scaler" class="scaler"></section>
  <iframe id="preview" class="preview" src="about:blank"></iframe>
  <section id="card_backdrop" class="card-backdrop"></section>
  <section id="settings_card" class="card dialog" data-card="dialog">
    <section class="header">
      <button class="card-back"><svg><use href="#back_icon"/></svg></button>
      <span class="title">Settings</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item list start">
          <div class="select">
            <label for="view_setting">Default View:</label>
            <div class="menu">
              <button id="view_setting" class="opener">Code<svg><use href="#back_icon"/></svg></button>
              <ul class="list selectable">
                <li class="list-item selected" onclick="updateSelect('view','code');">Code</li>
                <li class="list-item" onclick="updateSelect('view','split');">Split</li>
              </ul>
            </div>
          </div>
          <div class="select">
            <label for="orientation_setting">Default Orientation:</label>
            <div class="menu">
              <button id="orientation_setting" class="opener">Horizontal<svg><use href="#back_icon"/></svg></button>
              <ul class="list selectable">
                <li class="list-item selected" onclick="updateSelect('orientation','horizontal');">Horizontal</li>
                <li class="list-item" onclick="updateSelect('orientation','vertical');">Vertical</li>
              </ul>
            </div>
          </div>
          <div class="checkbox">
            <input id="refresh_setting" type="checkbox" oninput="updateCheckbox('refresh');" checked>
            <label for="refresh_setting"><svg class="check"><use href="#check_icon"/></svg>Automatically Refresh Preview</label>
          </div>
          <div class="checkbox">
            <input id="editing_tools_setting" type="checkbox" oninput="updateCheckbox('editing_tools');">
            <label for="editing_tools_setting"><svg class="check"><use href="#check_icon"/></svg>Open Editing Tools</label>
          </div>
        </div>
      </div>
      <div class="options">
        <button id="install_button" class="hidden" onclick="installApp();"><img src="resources/icon.svg">Install</button>
        <button id="theme_button" onclick="openCard(theme_card);" data-card-previous="theme_card"><svg><use href="#arrow_icon"/></svg></button>
      </div>
      <div class="options">
        <button id="clear_cache_button" class="warning hidden" onclick="clearCache();">Clear Cache</button>
        <button class="warning" onclick="resetSettings();">Reset Settings</button>
      </div>
    </section>
  </section>
  <section id="theme_card" class="card dialog" data-card="dialog">
    <section class="header">
      <button class="card-back" data-card-parent="settings_card"><svg><use href="#back_icon"/></svg></button>
      <span class="title">Theme</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item list expand">
          <div data-numbered-container>
            <textarea id="theme_setting" placeholder="CSS to modify..."></textarea>
          </div>
        </div>
      </div>
      <div class="options">
        <button onclick="resetTheme();">Reset Theme</button>
      </div>
    </section>
  </section>
  <section id="reset_settings_card" class="card alert" data-card="alert">
    <section class="header">
      <img class="icon" src="resources/settings.svg">
      <span class="title">Reset Settings</span>
    </section>
    <section class="main">
      <div class="content">
        <div class="item">Your settings have been reset!</div>
      </div>
    </section>
  </section>
  <section id="cleared_cache_card" class="card alert" data-card="alert">
    <section class="header">
      <img class="icon" src="resources/template.svg">
      <span class="title">Cleared Cache</span>
    </section>
    <section class="main">
      <div class="content">
        <div class="item">Successfully cleared offline cache!</div>
      </div>
    </section>
  </section>
  <section id="editing_tools_card" class="card widget" data-card="widget">
    <section class="main">
      <div class="content">
        <div class="options">
          <button id="undo_tool" onclick="callCommand(Editor.query().textarea,'undo'); this.focus();"><svg><use href="#undo_icon"/></svg></button>
          <button id="redo_tool" onclick="callCommand(Editor.query().textarea,'redo'); this.focus();"><svg><use href="#redo_icon"/></svg></button>
          <button id="refresh_tool" onclick="forceRefresh();" disabled><svg><use href="#refresh_icon"/></svg></button>
        </div>
      </div>
    </section>
  </section>
  <section id="replace_text_card" class="card widget" data-card="widget">
    <section class="header">
      <button class="card-back"><svg><use href="#back_icon"/></svg></button>
      <span class="title">Replace Text</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item list expand">
          <div data-numbered-container>
            <textarea id="replacer_find" placeholder="Text to find..."></textarea>
          </div>
          <div data-numbered-container>
            <textarea id="replacer_replace" placeholder="Replace with..."></textarea>
          </div>
        </div>
      </div>
      <div class="options">
        <button onclick="activateReplacer();">Replace</button>
        <button onclick="flipReplacer();">Flip</button>
        <button onclick="clearReplacer();">Clear</button>
      </div>
    </section>
  </section>
  <section id="color_picker_card" class="card widget" data-card="widget">
    <section class="header">
      <button class="card-back"><svg><use href="#back_icon"/></svg></button>
      <span class="title">Color Picker</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item list">
          <div id="picker_preview"></div>
          <input id="picker_input" type="text" value="#ee8800" maxlength="7" placeholder="#rrggbb">
        </div>
        <div class="item list">
          <label for="red_channel">Red</label>
          <input id="red_channel" type="range">
          <label for="green_channel">Green</label>
          <input id="green_channel" type="range">
          <label for="blue_channel">Blue</label>
          <input id="blue_channel" type="range">
        </div>
      </div>
      <div class="options">
        <button onclick="copyPicker();">Copy</button>
        <button onclick="insertPicker();">Insert</button>
        <button onclick="deletePicker();">Delete</button>
      </div>
    </section>
  </section>
  <section id="json_formatter_card" class="card widget" data-card="widget">
    <section class="header">
      <button class="card-back"><svg><use href="#back_icon"/></svg></button>
      <span class="title">JSON Formatter</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item expand">
          <div class="expand" data-numbered-container>
            <textarea id="formatter_input" placeholder="JSON data to format..."></textarea>
          </div>
        </div>
      </div>
      <div class="options">
        <button onclick="activateFormatter('  ');">Format</button>
        <button onclick="activateFormatter('');">Collapse</button>
        <button onclick="formatter_input.num_changeValue('');">Clear</button>
      </div>
    </section>
  </section>
  <section id="uri_encoder_card" class="card widget" data-card="widget">
    <section class="header">
      <button class="card-back"><svg><use href="#back_icon"/></svg></button>
      <span class="title">URI Encoder</span>
      <section class="card-controls">
        <button class="control" data-control="minimize"><svg><use href="#minimize_icon"/></svg></button>
        <button class="control" data-control="close"><svg><use href="#close_icon"/></svg></button>
      </section>
    </section>
    <section class="main">
      <div class="content">
        <div class="item expand">
          <div class="expand" data-numbered-container>
            <textarea id="encoder_input" placeholder="Text to encode..."></textarea>
          </div>
        </div>
      </div>
      <div class="options">
        <button onclick="activateEncoder(true);">Encode</button>
        <button onclick="activateEncoder(false);">Decode</button>
        <button onclick="encoder_input.num_changeValue('');">Clear</button>
      </div>
      <div class="options">
        <div class="checkbox">
          <input id="component_setting" type="checkbox">
          <label for="component_setting"><svg class="check"><use href="#check_icon"/></svg>Enable URI Component</label>
        </div>
      </div>
    </section>
  </section>
  <section id="context_menu" class="menu context-menu">
    <ul class="list">
      <li class="list-item global" onclick="window.location.reload();">Reload<span class="info shortcut ctrl command">R</span></li>
      <li class="list-item link" onclick="Editor.context_menu_previous.click();">Open in New Tab</li>
      <li class="list-item web-sharing link" onclick="navigator.share({ url: Editor.context_menu_previous.href });">Share Link</li>
      <li class="list-item web-sharing-alt link" onclick="navigator.clipboard.writeText(Editor.context_menu_previous.href).catch(error => alert('Clipboard could not be written to, please check site permissions for clipboard use.'));">Copy Link</li>
      <li class="list-item editing" onclick="callCommand(Editor.context_menu_previous,'undo');">Undo<span class="info shortcut ctrl command">Z</span></li>
      <li class="list-item editing" onclick="callCommand(Editor.context_menu_previous,'redo');">Redo<span class="info shortcut ctrl-shift shift-command">Z</span></li>
      <li class="list-item editing" onclick="callCommand(Editor.context_menu_previous,'cut');">Cut<span class="info shortcut ctrl command">X</span></li>
      <li class="list-item editing" onclick="callCommand(Editor.context_menu_previous,'copy');">Copy<span class="info shortcut ctrl command">C</span></li>
      <li class="list-item editing" onclick="callCommand(Editor.context_menu_previous,'paste');">Paste<span class="info shortcut ctrl command">V</span></li>
      <li class="list-item editing" onclick="Editor.context_menu_previous.select();">Select All<span class="info shortcut ctrl command">A</span></li>
    </ul>
  </section>
</main>

<script>
  if (Editor.environment().electron_container) window.mainProcess.receive("refresh-maximize",refreshMaximizeControl);
  document.querySelectorAll("header .window-controls .control").forEach(control => {
    control.setAttribute("tabindex","-1");
    if (!Editor.environment().electron_container) return;
    var controlType = control.getAttribute("data-control");
    if (controlType == "minimize") control.addEventListener("click",() => window.mainProcess.minimize());
    if (controlType == "maximize") control.addEventListener("click",() => {
      if (!window.mainProcess.isMaximized()){
        window.mainProcess.maximize();
      } else window.mainProcess.unmaximize();
    });
    if (controlType == "close") control.addEventListener("click",() => window.mainProcess.close());
  });
  document.querySelectorAll("a[href]").forEach(anchor => {
    anchor.rel = "noopener";
    anchor.target = "_blank";
    attachContextMenu({
      element: anchor,
      type: "link"
    });
  });
  document.querySelectorAll("img").forEach(image => {
    if (!image.alt) image.alt = "";
    image.draggable = false;
  });
  document.querySelectorAll("input[type='text']").forEach(input => applyEditingBehavior({ element: input }));
  document.querySelectorAll("textarea").forEach(textarea => applyEditingBehavior({ element: textarea }));
  var menus = document.querySelectorAll(".menu");
  menus.forEach(menu => {
    var opener = menu.querySelector(".opener"), lists = menu.querySelectorAll(".list"), listItems = menu.querySelectorAll(".list-item"), subLists = menu.querySelectorAll(".list-parent > .list");
    menu.addEventListener("mousedown",event => event.stopPropagation());
    menu.addEventListener("touchend",event => event.stopPropagation());
    menu.addEventListener("click",event => {
      if (event.target.matches(".list-item:not(.list-parent)")){
        event.stopPropagation();
        closeMenu(menu);
      }
    });
    menu.addEventListener("keydown",event => {
      if (!menu.classList.contains("active")) return;
      //if (event.key != "Escape" && event.key != "Tab") return;
      if (event.key == "Enter" || event.key == " "){
        event.preventDefault();
        event.stopPropagation();
        if (event.target.matches(".list-item:not(.list-parent)")){
          event.target.click();
        }
        if (event.target.matches(".list-item.list-parent")){
          openSubList(event.target.querySelector(".list"));
        }
      }
      if (event.key == "Escape" || event.key == "Tab"){
        event.preventDefault();
        event.stopPropagation();
        if (event.key != "Escape" && !menu.closest(".select")) return;
        closeMenu(menu);
      }
    });
    if (opener){
      if (!menu.classList.contains("alternate")){
        opener.addEventListener("mousedown",event => {
          if (event.button == 0) openMenu(menu);
        });
        opener.addEventListener("touchstart",() => openMenu(menu),{ passive: true });
        opener.addEventListener("keydown",event => {
          if (event.key == "Enter" || event.key == " ") openMenu(menu);
        });
      } else {
        attachContextMenu({
          element: opener,
          type: "alternate"
        });
      }
      opener.addEventListener("keydown",event => {
        if (!menu.classList.contains("active")) return;
        var navigable = getNavigableElements({
          container: lists[0],
          scope: true
        });
        if (event.key == "ArrowDown") navigable[0].focus();
        if (event.key == "ArrowUp") navigable[navigable.length - 1].focus();
      });
    }
    lists.forEach(list => {
      list.addEventListener("click",event => {
        if (!list.classList.contains("selectable") || !event.target.matches(".list-item") || event.target.classList.contains("non-selectable")) return;
        var listItems = list.querySelectorAll(".list-item");
        listItems.forEach(listItem => {
          if (listItem.classList.contains("selected")) listItem.classList.remove("selected");
        });
        event.target.classList.add("selected");
      });
      list.addEventListener("mousedown",event => {
        var navigable = getNavigableElements({
          container: list,
          scope: true
        });
        event.stopPropagation();
        //if (navigable.indexOf(event.target) != -1) ;
      });
      list.addEventListener("keydown",event => {
        if (event.key != "ArrowDown" && event.key != "ArrowUp") return;
        var navigable = getNavigableElements({
          container: list,
          scope: true
        });
        event.preventDefault();
        event.stopPropagation();
        if (event.key == "ArrowDown"){
          if (document.activeElement == navigable[navigable.length - 1]){
            navigable[0].focus();
          } else navigable[navigable.indexOf(document.activeElement) + 1].focus();
        }
        if (event.key == "ArrowUp"){
          if (document.activeElement == navigable[0]){
            navigable[navigable.length - 1].focus();
          } else navigable[navigable.indexOf(document.activeElement) - 1].focus();
        }
      });
    });
    listItems.forEach(listItem => {
      var list = listItem.closest(".list"), listParent = list.closest(".list-parent"), subLists = list.querySelectorAll(".list"), type = listItem.tagName.toLowerCase();
      listItem.addEventListener("mouseenter",event => {
        subLists.forEach(subList => {
          var listParent = subList.closest(".list-parent");
          if (listItem != listParent && listParent.classList.contains("active") && !listParent.contains(Editor.context_menu_previous) && !subList.contains(listItem) && !subList.contains(document.activeElement)) listParent.classList.remove("active");
        });
      });
      if (type != "a") listItem.setAttribute("tabindex","0");
    });
    subLists.forEach(subList => {
      var listParent = subList.closest(".list-parent");
      listParent.addEventListener("mouseenter",() => {
        if (!listParent.classList.contains("active")) listParent.classList.add("active");
      });
      listParent.addEventListener("click",event => openSubList(subList));
      listParent.addEventListener("keydown",event => {
        if (event.key != "Enter" && event.key != " " && event.key != "ArrowRight" && event.key != "ArrowLeft") return;
        event.preventDefault();
        event.stopPropagation();
        if (event.key == "Enter" || event.key == " " || event.key == "ArrowRight") openSubList(subList);
        if (event.key == "ArrowLeft") closeSubList(subList);
      });
      subList.addEventListener("click",event => event.stopPropagation());
    });
    function openSubList(subList){
      var listParent = subList.closest(".list-parent");
      if (listParent.classList.contains("active")) return closeSubList(subList);
      if (subList.contains(document.activeElement)) return;
      listParent.classList.add("active");
      if (event.type == "click") return;
      var navigable = getNavigableElements({
        container: subList,
        scope: true
      });
      window.setTimeout(() => navigable[0].focus(),20);
    }
    function closeSubList(subList){
      var listParent = subList.closest(".list-parent"), listParents = listParent.querySelectorAll(".list-parent");
      listParent.focus();
      listParent.classList.remove("active");
      if (listParents.length != 0) listParents.forEach(listParent => {
        if (listParent.classList.contains("active")) listParent.classList.remove("active");
      });
    }
  });
  document.querySelectorAll(".checkbox").forEach(checkbox => {
    var input = checkbox.querySelector("input[type='checkbox']");
    checkbox.addEventListener("click",() => input.click());
    checkbox.addEventListener("keydown",event => {
      if (event.key == "Enter" || event.key == " ") input.click();
    });
    checkbox.setAttribute("tabindex","0");
    input.addEventListener("click",event => event.stopPropagation());
  });
  var cards = document.querySelectorAll(".card");
  cards.forEach(card => {
    if (!card.querySelector(".header .card-controls")) return;
    var header = card.querySelector(".header"), back = header.querySelector(".card-back"), cardControls = header.querySelector(".card-controls"), minimize = cardControls.querySelector(".control[data-control='minimize']"), close = cardControls.querySelector(".control[data-control='close']");
    back.addEventListener("click",() => openCard(document.querySelector(`#${back.getAttribute("data-card-parent")}`),card));
    minimize.addEventListener("click",() => minimizeCard(card));
    minimize.addEventListener("keydown",event => {
      if (event.key != "Enter") return;
      event.preventDefault();
      if (event.repeat) return;
      minimize.click();
    });
    close.addEventListener("click",() => closeCard(card));
    if (Editor.environment().macOS_device){
      cardControls.insertBefore(close,minimize);
      header.insertBefore(cardControls,header.firstChild);
    }
    var navigable = getNavigableElements({
      container: card,
      scope: true
    });
    card.addEventListener("keydown",event => {
      if (card.getAttribute("data-card") != "dialog" || event.key != "Tab") return;
      if (!event.shiftKey){
        if (document.activeElement != navigable[navigable.length - 1]) return;
        event.preventDefault();
        navigable[0].focus();
      } else if (document.activeElement == navigable[0]){
        event.preventDefault();
        navigable[navigable.length - 1].focus();
      }
    });
  });
  window.addEventListener("load",() => {
    if (!("serviceWorker" in navigator) || !Editor.appearance().parent_window || window.location.protocol != "https:") return;
    navigator.serviceWorker.register("service-worker.js");
    if (!navigator.serviceWorker.controller) return;
    navigator.serviceWorker.addEventListener("message",event => {
      if (event.data.action == "open-files"){
        var files = Array.from(event.data.files);
        files.forEach(file => {
          var reader = new FileReader();
          reader.readAsText(file,"UTF-8");
          reader.addEventListener("loadend",() => createEditor({
            name: file.name,
            value: reader.result
          }));
        });
      }
      if (event.data.action == "clear-cache-success") openCard(cleared_cache_card);
    });
    clear_cache_option.classList.remove("hidden");
    clear_cache_button.classList.remove("hidden");
  });
  window.addEventListener("beforeinstallprompt",event => {
    event.preventDefault();
    Editor.install_prompt = event;
    install_option.classList.remove("hidden");
    install_button.classList.remove("hidden");
  });
  window.addEventListener("beforeunload",event => {
    if (Editor.unsaved_work()) return;
    event.preventDefault();
    event.returnValue = "";
  });
  window.addEventListener("unload",() => Editor.child_windows.forEach(win => win.close()));
  window.addEventListener("resize",event => {
    if (context_menu.classList.contains("active")) closeMenu(context_menu);
    if (Editor.view() != "preview") setEditorTabsVisibility();
    if (Editor.view() != "split" || !document.body.hasAttribute("data-scaling-offset")) return;
    var previousWidth = window.innerWidth, previousHeight = window.innerHeight;
    window.setTimeout(() => {
      if ((Editor.orientation() == "horizontal" && window.innerWidth != previousWidth) || (Editor.orientation() == "vertical" && window.innerHeight != previousHeight)) setView("split");
    },100);
  });
  window.addEventListener("blur",() => {
    if (Editor.appearance().parent_window) menus.forEach(menu => {
      if (menu.classList.contains("active")) closeMenu(menu);
    });
  });
  document.body.addEventListener("keydown",event => {
    var pressed = key => (event.key.toLowerCase() == key.toLowerCase()), control = (event.ctrlKey && !Editor.environment().apple_device), command = (event.metaKey && Editor.environment().apple_device), shift = (event.shiftKey || ((event.key.toUpperCase() == event.key) && (event.key + event.key == event.key * 2))), controlShift = (control && shift), shiftCommand = (shift && command), controlCommand = (event.ctrlKey && command);
    if (pressed("Escape")){
      event.preventDefault();
      if (event.repeat) return;
      if (context_menu.classList.contains("active")) return closeMenu(context_menu);
      if (Editor.active_dialog) closeCard(Editor.active_dialog);
    }
    if ((controlShift || shiftCommand) && pressed("x")){
      event.preventDefault();
      if (event.repeat) return;
      createEditor();
    }
    if ((controlShift || shiftCommand) && pressed("d")){
      event.preventDefault();
      if (event.repeat) return;
      closeEditor();
    }
    if ((controlShift || controlCommand) && (pressed("[") || pressed("{"))){
      event.preventDefault();
      if (event.repeat) return;
      openNextEditor();
    }
    if ((controlShift || controlCommand) && (pressed("]") || pressed("}"))){
      event.preventDefault();
      if (event.repeat) return;
      openPreviousEditor();
    }
    if ((controlShift || shiftCommand) && pressed("c")){
      event.preventDefault();
      if (event.repeat) return;
      createWindow();
    }
    if ((control || command) && pressed("o")){
      event.preventDefault();
      if (event.repeat) return;
      openFiles();
    }
    if ((controlShift || shiftCommand) && pressed("r")){
      event.preventDefault();
      if (event.repeat) return;
      renameEditor();
    }
    if ((control || command) && pressed("s")){
      event.preventDefault();
      if (event.repeat) return;
      saveFile();
    }
    if ((controlShift || controlCommand) && (pressed("1") || pressed("!"))){
      event.preventDefault();
      if (event.repeat) return;
      setView("code");
    }
    if ((controlShift || controlCommand) && (pressed("2") || pressed("@"))){
      event.preventDefault();
      if (event.repeat) return;
      setView("split");
    }
    if ((controlShift || controlCommand) && (pressed("3") || pressed("#"))){
      event.preventDefault();
      if (event.repeat) return;
      setView("preview");
    }
    if ((controlShift || controlCommand) && (pressed("4") || pressed("$"))){
      event.preventDefault();
      if (event.repeat) return;
      setOrientation();
    }
    if ((controlShift || controlCommand) && (pressed("5") || pressed("%"))){
      event.preventDefault();
      if (event.repeat) return;
      createDisplay();
    }
    if ((controlShift || shiftCommand) && pressed("Enter")){
      event.preventDefault();
      if (event.repeat) return;
      refreshPreview({ force: true });
    }
    if ((controlShift || shiftCommand) && pressed("e")){
      event.preventDefault();
      if (event.repeat) return;
      openCard(editing_tools_card);
    }
    if ((controlShift || shiftCommand) && pressed("f")){
      event.preventDefault();
      if (event.repeat) return;
      openCard(replace_text_card);
    }
    if ((controlShift || shiftCommand) && pressed("k")){
      event.preventDefault();
      if (event.repeat) return;
      openCard(color_picker_card);
    }
    if ((controlShift || shiftCommand) && pressed("g")){
      event.preventDefault();
      if (event.repeat) return;
      openCard(json_formatter_card);
    }
    if ((controlShift || shiftCommand) && pressed("y")){
      event.preventDefault();
      if (event.repeat) return;
      openCard(uri_encoder_card);
    }
    if ((controlShift || shiftCommand) && pressed("h")){
      event.preventDefault();
      if (event.repeat) return;
      insertMarkupTemplate();
      //confirmOverwrite(insertTemplate);
    }
    if ((controlShift || shiftCommand) && pressed("m")){
      event.preventDefault();
      if (event.repeat || !Editor.active_widget) return;
      minimizeCard(Editor.active_widget);
    }
    if ((controlShift || shiftCommand) && (pressed(".") || pressed(">"))){
      event.preventDefault();
      if (event.repeat) return;
      openCard(settings_card);
    }
  });
  document.body.addEventListener("mousedown",event => {
    if (event.button != 2) return;
    event.preventDefault();
    event.stopPropagation();
  });
  document.body.addEventListener("contextmenu",event => event.preventDefault());
  document.body.addEventListener("drop",() => menus.forEach(menu => {
    if (menu.classList.contains("active")) closeMenu(menu);
  }));
  document.body.addEventListener("dragend",() => document.querySelectorAll("textarea").forEach(textarea => textarea.num_refreshLineCount()));
  var toolbar = document.querySelector("header .menubar");
  toolbar.querySelectorAll(".menu").forEach(menu => {
    menu.addEventListener("mouseenter",() => {
      if (toolbar.querySelectorAll(".menu:not(.alternate).active").length == 0 || menu.classList.contains("alternate") || menu.classList.contains("active")) return;
      openMenu(menu);
    });
  });
  workspace_tabs.addEventListener("dragover",event => {
    event.preventDefault();
    workspace_tabs.classList.add("drag");
    event.dataTransfer.dropEffect = "copy";
  });
  workspace_tabs.addEventListener("dragleave",() => workspace_tabs.classList.remove("drag"));
  workspace_tabs.addEventListener("drop",event => {
    event.preventDefault();
    workspace_tabs.classList.remove("drag");
    Array.from(event.dataTransfer.items).forEach(async item => {
      if (item.kind == "file"){
        if (!Editor.support.file_system || !("getAsFileSystemHandle" in item)){
          var file = item.getAsFile(), reader = new FileReader();
          reader.readAsText(file,"UTF-8");
          reader.addEventListener("loadend",() => createEditor({
            name: file.name,
            value: reader.result
          }));
        } else {
          var handle = await item.getAsFileSystemHandle();
          if (handle.kind != "file") return;
          var file = await handle.getFile(), identifier = createEditor({
            name: await file.name,
            value: await file.text()
          });
          Editor.file_handles[identifier] = await handle;
        }
      } else if (item.kind == "string") createEditor({
        value: event.dataTransfer.getData("text")
      });
    });
  });
  scaler.addEventListener("mousedown",() => {
    if (event.button != 0) return;
    if (Editor.view() != "split") return;
    document.body.setAttribute("data-scaling-active",true);
    document.addEventListener("mousemove",setScaling);
    document.addEventListener("mouseup",disableScaling);
  });
  scaler.addEventListener("touchstart",event => {
    if (Editor.view() != "split" || event.touches.length != 1) return;
    document.body.setAttribute("data-scaling-active",true);
    document.addEventListener("touchmove",setScaling,{ passive: true });
    document.addEventListener("touchend",disableScaling,{ passive: true });
  },{ passive: true });
  card_backdrop.addEventListener("click",() => closeCard(Editor.active_dialog));

  if (Editor.environment().electron_container) refreshMaximizeControl();
  createEditor();
  if (Editor.support().file_handling && Editor.support().file_system){
    window.launchQueue.setConsumer(params => {
      closeEditor();
      params.files.forEach(async handle => {
        var file = await handle.getFile(), identifier = createEditor({
          name: await file.name,
          value: await file.text()
        });
        Editor.file_handles[identifier] = await handle;
      });
      if (!Editor.environment().touch_device) Editor.query().textarea.focus();
    });
  }
  if (Editor.appearance().parent_window) window.setTimeout(() => document.documentElement.classList.remove("startup-fade"),50);
  if (Editor.support().editing_commands){
    undo_tool.classList.add("hidden");
    redo_tool.classList.add("hidden");
  }
  var queryParameters = new URLSearchParams(window.location.search);
  if (queryParameters.get("template")){
    confirmOverwrite(insertTemplate);
    removeQueryParameters(["template"]);
  }
  if (queryParameters.get("settings")){
    openCard(settings_card);
    removeQueryParameters(["settings"]);
  }
  function createEditor({ name = "Untitled.txt", value = "", open = true } = {}){
    var identifier = Math.random().toString(), tab = document.createElement("button"), editorName = document.createElement("span"), editorClose = document.createElement("button"), container = document.createElement("div"), textarea = document.createElement("textarea"), previewOption = document.createElement("li");
    if (!name.includes(".")) name = `${name}.txt`;
    tab.classList.add("tab");
    tab.setAttribute("data-editor-identifier",identifier);
    if (value) tab.setAttribute("data-editor-refresh",true);
    tab.addEventListener("mousedown",event => {
      if (event.button != 0 || document.activeElement.matches("[data-editor-rename]")) return;
      event.preventDefault();
      if (tab != Editor.query().tab) openEditor(identifier);
    });


    tab.addEventListener("contextmenu",event => {
      if (event.target != tab) return;
      var editorRename = tab.querySelector("[data-editor-rename]");
      if (!editorRename){
        editorRename = document.createElement("input");
      } else return editorRename.blur();
      editorRename.type = "text";
      editorRename.placeholder = Editor.query(identifier).getName();
      editorRename.setAttribute("data-editor-rename",true);
      editorRename.setAttribute("tabindex","-1");
      editorRename.style.setProperty("--editor-name-width",`${editorName.getBoundingClientRect().width}px`);
      editorRename.value = Editor.query(identifier).getName();
      editorRename.addEventListener("keydown",event => {
        if (event.key == "Escape") editorRename.blur();
      });
      editorRename.addEventListener("change",() => {
        if (editorRename.value) renameEditor({
          identifier,
          name: editorRename.value
        });
        editorRename.blur();
      });
      editorRename.addEventListener("blur",() => editorRename.remove());
      tab.insertBefore(editorRename,tab.firstChild);
      applyEditingBehavior({
        element: editorRename,
        advanced: false
      });
      editorRename.focus();
      editorRename.select();
    });


    tab.addEventListener("dragover",event => {
      event.preventDefault();
      event.stopPropagation();
      event.dataTransfer.dropEffect = "copy";
      if (tab != Editor.query().tab) openEditor(identifier);
    });
    tab.addEventListener("drop",event => {
      event.preventDefault();
      event.stopPropagation();
    });
    editorName.setAttribute("data-editor-name",name);
    editorName.innerText = name;
    editorClose.classList.add("option");
    editorClose.setAttribute("tabindex","-1");
    editorClose.innerHTML = "<svg><use href='#close_icon'/></svg>";
    editorClose.addEventListener("mousedown",event => event.stopPropagation());
    editorClose.addEventListener("click",event => {
      event.stopPropagation();
      closeEditor({ identifier });
    });
    container.classList.add("editor");
    container.setAttribute("data-editor-identifier",identifier);
    container.setAttribute("data-numbered-container",true);
    textarea.value = value;
    textarea.setSelectionRange(0,0);
    textarea.addEventListener("input",() => {
      if (!tab.hasAttribute("data-editor-refresh")) tab.setAttribute("data-editor-refresh",true);
      if (!tab.hasAttribute("data-editor-unsaved")) tab.setAttribute("data-editor-unsaved",true);
      refreshPreview();
    });
    previewOption.classList.add("list-item");
    previewOption.setAttribute("data-editor-identifier",identifier);
    previewOption.setAttribute("tabindex","0");
    previewOption.innerText = name;
    previewOption.addEventListener("click",() => setPreviewSource({ identifier }));
    tab.appendChild(editorName);
    tab.appendChild(editorClose);
    workspace_tabs.appendChild(tab);
    container.appendChild(textarea);
    workspace_editors.appendChild(container);
    preview_options.appendChild(previewOption);
    applyEditingBehavior({ element: textarea });
    if (open || !Editor.active_editor) openEditor(identifier);
    return identifier;
  }
  function openEditor(identifier){
    if (!identifier) return;
    var { tab, container, getName } = Editor.query(identifier);
    if (Editor.query().tab) Editor.query().tab.classList.remove("active");
    if (Editor.query().container) Editor.query().container.classList.remove("active");
    tab.classList.add("active");
    container.classList.add("active");
    Editor.active_editor = identifier;
    setEditorTabsVisibility();
    setTitle(getName());
    if (Editor.preview_editor == "active-editor") refreshPreview({ force: true });
  }
  function closeEditor({ identifier = Editor.active_editor } = {}){
    if (!identifier) return;
    var { tab, container, textarea, getName } = Editor.query(identifier), previewOption = preview_options.querySelector(`.list-item[data-editor-identifier="${identifier}"]`), active = (tab.classList.contains("active")), focused = (document.activeElement == textarea), editorTabs = Array.from(workspace_tabs.querySelectorAll(".tab"));
    if (tab.hasAttribute("data-editor-unsaved")){
      if (!confirm(`Are you sure you would like to close "${getName()}"?\nRecent changes have not yet been saved.`)) return;
    }
    if (tab == editorTabs[0] && editorTabs.length == 1){
      Editor.active_editor = null;
      preview.src = "about:blank";
    }
    if (Editor.preview_editor == identifier) setPreviewSource({ active_editor: true });
    if (tab == editorTabs[0] && editorTabs[1] && tab.classList.contains("active")) openEditor(editorTabs[1].getAttribute("data-editor-identifier"));
    if (tab == editorTabs[editorTabs.length - 1] && tab != editorTabs[0] && tab.classList.contains("active")) openEditor(editorTabs[editorTabs.length - 2].getAttribute("data-editor-identifier"));
    if (tab != editorTabs[0] && tab.classList.contains("active")) openEditor(editorTabs[editorTabs.indexOf(tab) + 1].getAttribute("data-editor-identifier"));
    if (focused && Editor.query().textarea) Editor.query().textarea.focus();
    workspace_tabs.removeChild(tab);
    workspace_editors.removeChild(container);
    preview_options.removeChild(previewOption);
    if (Editor.file_handles[identifier]) delete Editor.file_handles[identifier];
  }
  function renameEditor({ name, identifier = Editor.active_editor } = {}){
    var { tab, getName } = Editor.query(identifier), editorName = tab.querySelector("[data-editor-name]"), previewOption = preview_options.querySelector(`.list-item[data-editor-identifier="${identifier}"]`), currentName = getName(), base = getName("base"), extension = getName("extension"), rename = (name) ? name : prompt(`Enter a new file name for "${currentName}".`,currentName);
    if (!rename) return;
    if (!rename.includes(".")){
      rename = `${rename}.${extension}`;
    } else if (rename.charAt(0) == ".") rename = `${base}${rename}`;
    editorName.innerText = rename;
    previewOption.innerText = rename;
    if (tab == Editor.query().tab) setTitle(rename);
    if ((Editor.preview_editor == "active-editor" && Editor.active_editor == identifier) || Editor.preview_editor == identifier) refreshPreview({ force: true });
    return rename;
  }
  function setEditorTabsVisibility({ identifier = Editor.active_editor } = {}){
    var { tab } = Editor.query(identifier);
    tab.scrollIntoView();
  }
  function setView(view){
    if (Editor.active_scaling()) return;
    document.body.classList.remove(Editor.view());
    document.body.setAttribute("data-view",view);
    document.body.classList.add(Editor.view());
    //removeScaling();
    if (view == "code") setEditingToolVisibility({
      undo: true,
      redo: true,
      refresh: false
    });
    if (view == "split") setEditingToolVisibility({
      undo: true,
      redo: true,
      refresh: true
    });
    if (view == "preview") setEditingToolVisibility({
      undo: false,
      redo: false,
      refresh: true
    });
    refreshPreview();
    function setEditingToolVisibility({ undo, redo, refresh } = {}){
      undo_tool.disabled = !undo;
      redo_tool.disabled = !redo;
      refresh_tool.disabled = !refresh;
    }
  }
  function setOrientation(orientation){
    if (Editor.active_scaling()) return;
    var param = (orientation), transitionDuration = ((Editor.view() != "split") ? 0 : parseInt(getElementStyle({
      element: workspace,
      property: "transition-duration"
    }).replace(/s/g,"") * 1000));
    if (!param && Editor.view() == "split") setView("code");
    if (!param && Editor.orientation() == "horizontal") orientation = "vertical";
    if (!param && Editor.orientation() == "vertical") orientation = "horizontal";
    window.setTimeout(() => {
    setTransitionDurations(false);
    document.body.classList.remove(Editor.orientation());
    document.body.setAttribute("data-orientation",orientation);
    document.body.classList.add(Editor.orientation());
    workspace.offsetHeight;
    scaler.offsetHeight;
    preview.offsetHeight;
    setTransitionDurations(true);
    if (!param) setView("split");
    },transitionDuration);
    function setTransitionDurations(value){
      if (value == true) {
        workspace.style.removeProperty("transition-duration");
        scaler.style.removeProperty("transition-duration");
        preview.style.removeProperty("transition-duration");
      }
      if (value == false){
        workspace.style.transitionDuration = "0s";
        scaler.style.transitionDuration = "0s";
        preview.style.transitionDuration = "0s";
      }
    }
  }
  function setPreviewSource({ identifier, active_editor }){
    if (!identifier && !active_editor) return;
    if ((!identifier && active_editor) || (Editor.preview_editor == identifier)){
      Editor.preview_editor = "active-editor";
    } else Editor.preview_editor = identifier;
    refreshPreview({ force: true });
  }
  function openCard(card,previous){
    if (card.classList.contains("active") && !card.hasAttribute("data-alert-timeout")) return closeCard(card);
    var type = card.getAttribute("data-card");
    if (type != "alert"){
      cards.forEach(openCard => {
        if (!openCard.classList.contains("active")) return;
        var openType = openCard.getAttribute("data-card");
        if (openType != "dialog" && openType != type) return;
        openCard.classList.remove("active");
        if (!openCard.classList.contains("minimize")) return;
        var transitionDuration = parseInt(getElementStyle({
          element: openCard,
          property: "transition-duration"
        }).replace(/s/g,"") * 1000);
        window.setTimeout(() => minimizeCard(openCard),transitionDuration);
      });
    }
    card.classList.add("active");
    if (type == "widget") card_backdrop.classList.remove("active");
    if (type == "alert"){
      var timeoutIdentifier = Math.random().toString();
      card.setAttribute("data-alert-timeout",timeoutIdentifier);
      window.setTimeout(() => {
        if (card.getAttribute("data-alert-timeout") != timeoutIdentifier) return;
        card.removeAttribute("data-alert-timeout");
        closeCard(card);
      },4000);
    }
    if (card == editing_tools_card) Editor.active_editing_tools = true;
    if (type == "dialog"){
      document.body.addEventListener("keydown",catchCardNavigation);
      card_backdrop.classList.add("active");
      if (!Editor.active_dialog && !Editor.dialog_previous){
        var menuItem = (document.activeElement.closest(".menu")), contextMenuItem = (document.activeElement.closest(".context-menu"));
        if (!menuItem && !contextMenuItem){
          Editor.dialog_previous = document.activeElement;
        } else if (menuItem){
          Editor.dialog_previous = document.activeElement.closest(".menu").querySelector(".opener");
        } else if (contextMenuItem) Editor.dialog_previous = Editor.context_menu_previous;
      }
      menus.forEach(menu => {
        if (menu.classList.contains("active")) closeMenu(menu);
      });
      var transitionDuration = parseInt(getElementStyle({
        element: card,
        property: "transition-duration"
      }).replace(/s/g,"") * 500);
      window.setTimeout(() => {
        document.activeElement.blur();
        if (previous) card.querySelector(`[data-card-previous="${previous.id}"]`).focus();
      },transitionDuration);
      Editor.active_dialog = card;
    }
    if (type == "widget") Editor.active_widget = card;
  }
  function closeCard(card){
    var type = card.getAttribute("data-card");
    card.classList.remove("active");
    if (card.classList.contains("minimize")){
      var transitionDuration = parseInt(getElementStyle({
        element: card,
        property: "transition-duration"
      }).replace(/s/g,"") * 1000);
      window.setTimeout(() => minimizeCard(card),transitionDuration);
    }
    if (type == "dialog"){
      document.body.removeEventListener("keydown",catchCardNavigation);
      card_backdrop.classList.remove("active");
      Editor.active_dialog = null;
      if (Editor.dialog_previous){
        var hidden = (getElementStyle({
          element: Editor.dialog_previous,
          property: "visibility"
        }) == "hidden");
        if (!workspace_editors.contains(Editor.dialog_previous) && !hidden){
          Editor.dialog_previous.focus();
        } else Editor.query().textarea.focus();
        Editor.dialog_previous = null;
      }
    }
    if (card == editing_tools_card) Editor.active_editing_tools = false;
    if (type == "widget") Editor.active_widget = null;
  }
  function minimizeCard(card){
    var minimize = card.querySelector(".header .card-controls .control[data-control='minimize']");
    card.classList.toggle("minimize");
    if (card.classList.contains("minimize") && card.contains(document.activeElement) && document.activeElement != minimize) minimize.focus();
  }
  function catchCardNavigation(){
    if (!Editor.active_dialog || context_menu.classList.contains("active") || event.key != "Tab" || document.activeElement != document.body) return;
    var navigable = getNavigableElements({
      container: Editor.active_dialog,
      scope: true
    });
    event.preventDefault();
    if (!event.shiftKey){
      navigable[0].focus();
    } else navigable[navigable.length - 1].focus();
  }


/*
  function catchCardNavigation(event){
    if (!Editor.active_modal || contextMenu.classList.contains("active") || event.key != "Tab" || document.activeElement != document.body) return;
    var navigable = getNavigableElements(Editor.active_modal);
    if (event.shiftKey){
      event.preventDefault();
      navigable[navigable.length - 1].focus();
    } else {
      event.preventDefault();
      navigable[0].focus();
    }
  }
*/

  function createWindow(){
    var features = (Editor.appearance().standalone || Editor.appearance().fullscreen) ? "popup" : "", win = window.open(window.location.href,"_blank",features);
    if (Editor.appearance().fullscreen){
      win.resizeTo(window.screen.width * 2/3,window.screen.height * 2/3);
      win.moveTo(window.screen.width / 6,window.screen.height / 6);
    } else if (Editor.appearance().standalone){
      win.resizeTo(window.outerWidth,window.outerHeight);
      win.moveTo(window.screenX,window.screenY);
    }
  }
  async function openFiles(){
    if (!Editor.support().file_system){
      var input = document.createElement("input");
      input.type = "file";
      input.multiple = true;
      input.click();
      input.addEventListener("change",() => {
        var files = Array.from(input.files);
        files.forEach(file => {
          var reader = new FileReader();
          reader.readAsText(file,"UTF-8");
          reader.addEventListener("loadend",() => createEditor({
            name: file.name,
            value: reader.result
          }));
        });
        input.value = null;
      });
    } else {
      var handles;
      if ("showOpenFilePicker" in window){
        handles = await window.showOpenFilePicker({
          multiple: true
        }).catch(error => {
          if (error.message.toLowerCase().includes("abort")) return;
        });
      } else if ("chooseFileSystemEntries" in window){
        handles = await window.chooseFileSystemEntries({
          type: "open-file",
          multiple: true
        }).catch(error => {
          if (error.message.toLowerCase().includes("abort")) return;
        });
      }
      if (handles) handles.forEach(async handle => {
        var file = await handle.getFile(), identifier = createEditor({
          name: await file.name,
          value: await file.text()
        });
        Editor.file_handles[identifier] = await handle;
      });
    }
  }
  async function saveFile(extension){
    if (extension || !Editor.support().file_system){
      if (!extension) extension = Editor.query().getName("extension");
      var anchor = document.createElement("a"), link = window.URL.createObjectURL(new Blob([Editor.query().textarea.value]));
      anchor.href = link;
      anchor.download = `${Editor.query().getName("base")}.${extension}`;
      anchor.click();
      window.URL.revokeObjectURL(link);
    } else {
      var identifier = Editor.active_editor, handle;
      if (!Editor.file_handles[identifier]){
        if ("showOpenFilePicker" in window){
          handle = await window.showSaveFilePicker().catch(error => {
            if (error.message.toLowerCase().includes("abort")) return;
          });
        } else if ("chooseFileSystemEntries" in window){
          handle = await window.chooseFileSystemEntries({
            type: "save-file"
          }).catch(error => {
            if (error.message.toLowerCase().includes("abort")) return;
          });
        }
        if (!handle) return;
        Editor.file_handles[identifier] = await handle;
      } else handle = Editor.file_handles[identifier];
      var stream = await Editor.file_handles[identifier].createWritable().catch(error => {
        alert(`"${Editor.query().getName()}" could not be saved.`);
        if (error.toString().toLowerCase().includes("not allowed")) return;
      });
      if (!stream) return;
      await stream.write(Editor.query().textarea.value);
      await stream.close();
      var currentName = Editor.query().getName(), file = await handle.getFile(), rename = await file.name;
      if (currentName != rename) renameEditor({
        name: rename
      });
    }
    Editor.query().tab.removeAttribute("data-editor-unsaved");
    refreshPreview({ force: true });
  }

  function createDisplay(){
    var width = window.screen.availWidth * 2/3,
      height = window.screen.availHeight * 2/3,
      left = window.screen.availWidth / 2 + window.screen.availLeft - width / 2,
      top = window.screen.availHeight / 2 + window.screen.availTop - height / 2,
      features = (Editor.appearance().standalone || Editor.appearance().fullscreen) ? "popup" : "",
      extension = Editor.query().getName("extension"),
      link = window.URL.createObjectURL(new Blob([Editor.query().textarea.value],{
        type: (["html","xml","md","markdown","svg"].includes(extension)) ? `text/${extension}` : `text/plain`
      })),
      win = window.open(link,"_blank",features);
    window.URL.revokeObjectURL(link);
    win.moveTo(left,top);
    win.resizeTo(width,height);
    Editor.child_windows.push(win);
    window.setTimeout(() => {
      if (!win.document.title) win.document.title = Editor.query().getName();
    },20);
  }
  function openMenu(menu,type){
    if (menu.classList.contains("active")) return closeMenu(menu);
    var opener = menu.querySelector(".opener"), list = menu.querySelectorAll(".list")[0];
    menus.forEach(menu => {
      if (menu.classList.contains("active")) closeMenu(menu);
    });
    menu.classList.add("active");
    if (opener && document.activeElement != opener) opener.focus();
    document.body.addEventListener("mousedown",catchMenuExit);
    document.body.addEventListener("touchend",catchMenuExit);
    function catchMenuExit(){
      if (menu.contains(event.target)) return;
      document.body.removeEventListener("mousedown",catchMenuExit);
      document.body.removeEventListener("touchend",catchMenuExit);
      if (event.button != "2") closeMenu(menu);
    }
    if (menu.closest(".select")){
      var selected, navigable = getNavigableElements({
        container: list,
        scope: true
      });
      navigable.forEach(element => {
        if (!selected && element.classList.contains("selected")) selected = element;
      });
      if (!selected) selected = navigable[0];
      window.setTimeout(() => selected.focus(),20);
    }
    if (!menu.classList.contains("context-menu")) return;
    if (Editor.context_menu_timeout) Editor.context_menu_timeout = null;
    Editor.context_menu_previous = event.target;
    menu.classList.add(type);
    var location = {};
    if (!Editor.environment.touch_device && !(event instanceof TouchEvent)){
      location.left = event.pageX;
      location.top = event.pageY;
    } else {
      location.left = event.touches[0].pageX;
      location.top = event.touches[0].pageY;
    }
    if (location.left + list.offsetWidth > window.innerWidth) location.left = window.innerWidth - list.offsetWidth;
    if (location.top + list.offsetHeight > window.innerHeight) location.top -= list.offsetHeight;
    menu.style.left = `${location.left}px`;
    menu.style.top = `${location.top}px`;
    //document.body.addEventListener("keydown",catchMenuNavigation);
    var transitionDuration = parseInt(getElementStyle({
      element: list,
      property: "transition-duration"
    }).replace(/s/g,"") * 500);
    window.setTimeout(() => document.activeElement.blur(),transitionDuration);
  }
  function closeMenu(menu){
    var opener = menu.querySelector(".opener"), list = menu.querySelectorAll(".list")[0], listParents = menu.querySelectorAll(".list-parent");
    menu.classList.remove("active");
    listParents.forEach(listParent => {
      if (listParent.classList.contains("active")) listParent.classList.remove("active");
    });
    if (opener && opener != document.activeElement) opener.focus();
    if (!menu.classList.contains("context-menu")) return;
    Editor.context_menu_previous.focus();
    var types = ["link","editing"], transitionDuration = parseInt(getElementStyle({
      element: list,
      property: "transition-duration"
    }).replace(/s/g,"") * 1000);
    window.setTimeout(() => {
      var types = ["link","editing"];
      types.forEach(type => {
        if (menu.classList.contains(type)) menu.classList.remove(type);
      });
    },transitionDuration);
  }
  function catchMenuNavigation(){
  }

  function getNavigableElements({ container, scope = false } = {}){
    scope = (scope) ? "" : ":scope > ";
    var navigable = container.querySelectorAll(`${scope}button:not([disabled]), ${scope}textarea:not([disabled]), ${scope}input:not([disabled]), ${scope}select:not([disabled]), ${scope}a[href]:not([disabled]), ${scope}[tabindex]:not([tabindex="-1"])`);
    return Array.from(navigable).filter(element => (getElementStyle({
      element,
      property: "display"
    }) != "none"));
  }
  function getElementStyle({ element, pseudo = null, property } = {}){
    return window.getComputedStyle(element,pseudo).getPropertyValue(property);
  }
  function applyEditingBehavior({ element, advanced = true } = {}){
    var type = element.tagName.toLowerCase();
    element.spellcheck = false;
    element.autocomplete = "off";
    element.autocapitalize = "off";
    element.setAttribute("autocorrect","off");
    if (type == "input"){
      if (!advanced) return;
      attachContextMenu({
        element: element,
        type: "editing"
      });
    } else if (type == "textarea"){
      var container = element.closest("[data-numbered-container]");
      container.num_establishContainer();
      if (!advanced) return;
      container.addEventListener("dragover",event => {
        container.classList.add("drag");
        event.dataTransfer.dropEffect = "copy";
      });
      container.addEventListener("dragleave",() => container.classList.remove("drag"));
      container.addEventListener("drop",event => {
        container.classList.remove("drag");
        if (Array.from(event.dataTransfer.items)[0].kind == "string"){
          window.setTimeout(() => element.num_refreshLineCount(),5);
        } else preventDefault();
      });
      attachContextMenu({
        element: container,
        type: "editing"
      });
    }
  }
  function attachContextMenu({ element, type } = {}){
    element.addEventListener("keydown",event => {
      if (event.repeat) return;
      if (!event.shiftKey || event.key != " ") return;
      event.preventDefault();
      element.dispatchEvent(new MouseEvent("contextmenu"));
    });
    element.addEventListener("mousedown",event => {
      if (event.button == "2") event.preventDefault();
    });
    element.addEventListener("contextmenu",event => {
      if (type == "alternate"){
        openMenu(element.closest(".menu"));
      } else if (Editor.support().editing_commands){
        openMenu(context_menu,type);
      } else {
        menus.forEach(menu => closeMenu(menu));
      }
    });
    element.addEventListener("touchstart",event => {
      if (event.touches.length == 1) Editor.context_menu_timeout = window.setTimeout(() => element.dispatchEvent(new MouseEvent("contextmenu")),750);
    },{ passive: true });
    element.addEventListener("touchmove",negateContextMenu,{ passive: true });
    element.addEventListener("touchend",negateContextMenu);
    function negateContextMenu(){
      if (!Editor.context_menu_timeout) return;
      window.clearTimeout(Editor.context_menu_timeout);
      Editor.context_menu_timeout = null;
    }
  }/*
  function sendShortcutAction({ control, command, shift, controlShift, shiftCommand, controlCommand, key } = {}){
    if (!key) return;
    var appleDevice = (Editor.environment().apple_device);
    control = ((control && !appleDevice) || (controlShift && !appleDevice) || (controlCommand && appleDevice)), command = ((command && appleDevice) || (shiftCommand && appleDevice) || (controlCommand && appleDevice)), shift = (shift || (controlShift && !appleDevice) || (shiftCommand && appleDevice)), key = key.toString().toLowerCase();
    document.body.dispatchEvent(new KeyboardEvent("keydown",{
      ctrlKey: control,
      metaKey: command,
      shiftKey: shift,
      key: key
    }));
  }*/
  function refreshPreview({ force = false } = {}){
    if (Editor.view() == "code") return;
    var source = (Editor.preview_editor == "active-editor") ? Editor.query() : Editor.query(Editor.preview_editor);
    if (!source.textarea) return;
    var change = (source.tab.hasAttribute("data-editor-refresh"));
    if (!change && !force) return;
    var extension = source.getName("extension"), type = (["html","xml","md","markdown","svg"].includes(extension)) ? `text/${extension}` : `text/plain`;
    if (["md","markdown"].includes(type)) type = "text/html";
    if (type == "text/svg") type = "image/svg+xml";
    var link = window.URL.createObjectURL(new Blob([source.textarea.value],{ type }));
    preview.src = link;
    window.URL.revokeObjectURL(link);
    if (change) source.tab.removeAttribute("data-editor-refresh");
  }
  function setTitle(name){
    document.title = `${name} - Smart Text Editor`;
  }
  function addQueryParameters(entries){
    var parameters = new URLSearchParams(window.location.search);
    entries.forEach(entry => parameters.set(entry,true));
    changeQueryParameters(parameters);
  }
  function removeQueryParameters(entries){
    var parameters = new URLSearchParams(window.location.search);
    entries.forEach(entry => parameters.delete(entry));
    changeQueryParameters(parameters);
  }
  function changeQueryParameters(parameters){
    var query = parameters.toString();
    if (query) query = "?" + query;
    var address = window.location.pathname + query;
    history.pushState(null,"",address);
  }
  function refreshMaximizeControl(){
    var maximizeControl = document.querySelector("header .window-controls .control[data-control='maximize']");
    maximizeControl.querySelectorAll("[data-icon]").forEach(icon => icon.classList.remove("active"));
    var icon = (!window.mainProcess.isMaximized()) ? "maximize" : "restore";
    maximizeControl.querySelector(`[data-icon="${icon}"]`).classList.add("active");
    maximizeControl.title = icon[0].toUpperCase() + icon.slice(1);
  }
</script>

</body>

</html>