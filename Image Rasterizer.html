<!DOCTYPE html>
<html>

<head>

<title>Image Rasterizer</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link id="favicon" rel="icon" type="image/png">

<style>
  *, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: sans-serif;
  }
  body {
    width: 100vw;
    height: 100vh;
  }
  svg {
    width: 256px;
    height: 256px;
  }
  #logo {
    position: absolute;
  }
  #canvas {
    width: 256px;
    height: 256px;
    image-rendering: pixelated;
  }
</style>

</head>

<body>

<svg id="logo">
  <defs>
    <linearGradient id="wood" x1="-22.662" x2="-32.039" y1="-27.117" y2="-27.117" gradientTransform="matrix(-9.3466 -9.3775 9.3775 -9.3466 0 0)" gradientUnits="userSpaceOnUse">
      <stop stop-color="#e5cfad" offset="0"/>
      <stop stop-color="#dec196" offset="0.25"/>
      <stop stop-color="#daba8a" offset="0.5"/>
      <stop stop-color="#c4a77c" offset="0.75"/>
      <stop stop-color="#988260" offset="1"/>
    </linearGradient>
    <linearGradient id="paint" x1="22.338" x2="31.811" y1="15.409" y2="15.409" gradientTransform="matrix(9.4412 9.4724 -9.4724 9.4412 0 0)" gradientUnits="userSpaceOnUse">
      <stop stop-color="#f3ac4d" offset="0"/>
      <stop stop-color="#f0941a" offset="0.25"/>
      <stop stop-color="#ee8800" offset="0.5"/>
      <stop stop-color="#d67a00" offset="0.75"/>
      <stop stop-color="#a65f00" offset="1"/>
    </linearGradient>
    <linearGradient id="metal" x1="22.267" x2="31.751" y1="-8.6537" y2="-8.6537" gradientTransform="matrix(9.4527 9.484 -9.484 9.4527 0 0)" gradientUnits="userSpaceOnUse">
      <stop stop-color="#d5d5d5" offset="0"/>
      <stop stop-color="#c9c9c9" offset="0.25"/>
      <stop stop-color="#c3c3c3" offset="0.5"/>
      <stop stop-color="#afafaf" offset="0.75"/>
      <stop stop-color="#888888" offset="1"/>
    </linearGradient>
    <linearGradient id="eraser" x1="22.164" x2="31.683" y1="-14.141" y2="-14.141" gradientTransform="matrix(9.4872 9.5187 -9.5187 9.4872 0 0)" gradientUnits="userSpaceOnUse">
      <stop stop-color="#db7c88" offset="0"/>
      <stop stop-color="#d15766" offset="0.25"/>
      <stop stop-color="#cc4455" offset="0.5"/>
      <stop stop-color="#b73d4c" offset="0.75"/>
      <stop stop-color="#8e2f3b" offset="1"/>
    </linearGradient>
  </defs>
  <symbol id="pencil" viewBox="0 0 512 512">
    <path d="m170.77 428.71-168.7 81.953 81.054-169.89z" fill="url(#wood)"/>
    <path d="m54.396 484.82-52.657 25.846 25.566-53.027z" fill="#2a2a2a"/>
    <path d="m314.47 108.52c-9.7304 9.7626 2.2127 37.574 26.676 62.118 24.463 24.544 52.182 36.527 61.913 26.764l-231.03 231.8c-9.7304 9.7626-37.45-2.2201-61.913-26.764-24.463-24.544-36.406-52.355-26.676-62.118z" fill="url(#paint)"/>
    <path d="m365.73 56.454c-9.827 9.8595 2.2347 37.947 26.94 62.734 24.706 24.788 52.7 36.889 62.527 27.03l-55.137 55.319c-9.827 9.8595-37.821-2.2421-62.527-27.03-24.706-24.788-36.767-52.875-26.94-62.734z" fill="url(#metal)"/>
    <path d="m417.17 4.7679c-9.8787 9.9114 2.2886 38.189 27.176 63.159 24.888 24.97 53.072 37.178 62.95 27.266l-54.165 54.344c-9.8787 9.9114-38.063-2.2962-62.95-27.266-24.888-24.97-37.055-53.247-27.176-63.159z" fill="url(#eraser)"/>
    <path d="m417.17 4.7679c9.8787-9.9114 38.063 2.2962 62.95 27.266 24.888 24.97 37.055 53.247 27.176 63.159s-38.062-2.2962-62.95-27.266c-24.888-24.97-37.055-53.247-27.176-63.159z" fill="#db7c88"/>
  </symbol>
</svg>

<svg><use href="#pencil"></use></svg>
<input id="sizeScaler" type="range" value="64" min="1" max="512">
<canvas id="canvas"></canvas>

<script>
  var pencil = `data:image/svg+xml,${encodeURIComponent(document.getElementById("logo").outerHTML.split("<svg ").join("<svg xmlns='http://www.w3.org/2000/svg' ").split("</svg>").join("<use href='#pencil'></use></svg>"))}`;
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");
  var sizeScaler = document.getElementById("sizeScaler");
  var baseImage = new Image();
  baseImage.src = pencil;
  setTimeout(function(){
    createImage();
  }, 100);

  sizeScaler.addEventListener("input",createImage);

  function createImage(){
    var isSafari = false;
    checkBrowser();
    var dimensions = sizeScaler.value;
    canvas.width = dimensions;
    canvas.height = dimensions;
    if (isSafari){
      ctx.drawImage(baseImage,0,0,dimensions,dimensions,0,0,dimensions,dimensions);
    } else {
      ctx.drawImage(baseImage,0,0,dimensions,dimensions,0,0,dimensions,dimensions);
    }
    favicon.href = canvas.toDataURL();
  }
  function checkBrowser(){
    var ua = navigator.userAgent.toLowerCase(); 
    try {
      isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || safari.pushNotification);
    }
    catch(err) {}
    isSafari = (isSafari || ((ua.indexOf('safari') != -1)&& (!(ua.indexOf('chrome')!= -1) && (ua.indexOf('version/')!= -1))));
    
    //test
    if (isSafari){
      //Code for Safari Browser (Desktop and Mobile)
      //alert("This is Safari!");
    } else {
      //alert("Not Safari!");
    }
  }
</script>

</body>

</html>